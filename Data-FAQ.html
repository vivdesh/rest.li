<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128576866-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-128576866-1');
    </script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>

    <title>Rest.li FAQ</title>
    <meta name="description" content="Rest.li FAQ" />

    <link rel="icon" type="image/png" href="/rest.li/assets/images/icon_pegasus.png">
  
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" media="screen,projection" href="/rest.li/assets/css/main.css">
    <link rel="canonical" href="/rest.li/Data-FAQ" />
    <link rel="alternate" type="application/rss+xml" title="rest.li" href="/rest.li/feed.xml" />

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <script src="//code.jquery.com/jquery-3.0.0.min.js"></script>
    <script src="/rest.li/assets/js/search-input.js"></script>
    

    
    <script>
       $(function() {
          $("h1").addClass("no_toc");
       });
    </script>
</head>


  <body>

    <nav class="dark-grey" role="navigation">
    <div class="nav-wrapper container"><a id="logo-container" class="brand-logo" href="/rest.li/">Rest.li</a>
      <ul class="right hide-on-med-and-down">
        
        <li>
          <a href="/rest.li/get_started/quick_start" >
            Getting Started
          </a>
        </li>
        
        <li>
          <a href="/rest.li/user_guide/server_architecture" >
            User Guide
          </a>
        </li>
        
        <li>
          <a href="/rest.li/spec/protocol" >
            API Reference
          </a>
        </li>
        
        <li>
          <a href="/rest.li/contribute/howto" >
            Contribute
          </a>
        </li>
        
          <li>
            <div class="center row" >
              <div class="col s12 ">
                <div class="row">
                  <div class="input-field col s6 s12 min">
                      <i id="search-txt" class="material-icons prefix">search</i>
                      <input type="text" id="search-input">
                    </div>
                  </div>
                </div>
              </div>
          </li>
          <li>
              <a id="github-menu" href="http://github.com/linkedin/rest.li/" >
                   <i class="fa fa-github"></i>
                </a>
          </li>
          </ul>
      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
</nav>



        <div class="container">
        <div class="row">
                <div class="col s12 m4 l3"> 
               
                    
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">User Guide</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/user_guide/server_architecture">Rest.li Architecture</a></li>
                       
                         <li><a href="/rest.li/user_guide/restli_server">Rest.li Server</a></li>
                       
                         <li><a href="/rest.li/user_guide/restli_client">Rest.li Client Framework</a></li>
                       
                         <li><a href="/rest.li/user_guide/unstructured_data">Unstructured Data</a></li>
                       
                         <li><a href="/rest.li/Components">Components</a></li>
                       
                         <li><a href="/rest.li/Asynchronous-Servers-and-Clients-in-Rest_li">Asynchronous in Rest.li</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Data Schemas</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/pdl_schema">PDL Schema</a></li>
                       
                         <li><a href="/rest.li/pdsc_syntax">PDSC Syntax</a></li>
                       
                         <li><a href="/rest.li/pdl_migration">Migrating from PDSC to PDL</a></li>
                       
                         <li><a href="/rest.li/avro_translation">Avro Translation</a></li>
                       
                         <li><a href="/rest.li/java_binding">Java Binding</a></li>
                       
                         <li><a href="/rest.li/annotation_processor">Schema Annotation Processor</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Modeling Resources</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/modeling/modeling">Modeling Resources</a></li>
                       
                         <li><a href="/rest.li/modeling/compatibility_check">Snapshots and Resource Compatibility Checking</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Data</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/how_data_is_serialized_for_transport">How Data is Serialized for Transport</a></li>
                       
                         <li><a href="/rest.li/how_data_is_represented_in_memory">How Data is Represented in Memory</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Main concepts</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Rest_li-Filters">Filters</a></li>
                       
                         <li><a href="/rest.li/Projections">Projections</a></li>
                       
                         <li><a href="/rest.li/pathspec">PathSpecs</a></li>
                       
                         <li><a href="/rest.li/Validation-in-Rest_li">Validation</a></li>
                       
                         <li><a href="/rest.li/Attachment-Streaming">Attachment Streaming</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Mutli-language</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/multi_language_compatibility_matrix">Compatibility Matrix</a></li>
                       
                         <li><a href="/rest.li/test_suite">Test Suite</a></li>
                       
                         <li><a href="https://github.com/mchen07/restli-csharp">C#</a></li>
                       
                         <li><a href="/rest.li/Scala-Integration">Scala Integration</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Testing</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Writing-unit-tests-for-Rest_li-clients-and-servers">Writing Unit Tests</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">How to</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Send-Rest_li-Request-Query-In-Request-Body">Send Request Query in the Body</a></li>
                       
                         <li><a href="/rest.li/How-to-use-projections-in-Java">Use Projections</a></li>
                       
                         <li><a href="/rest.li/Rest_li_Avro_conversions">Avro Conversion</a></li>
                       
                         <li><a href="/rest.li/Compression">Compression</a></li>
                       
                         <li><a href="/rest.li/Rest_li-2_x-upgrade-instructions">Migrate to Rest.li 2.x</a></li>
                       
                         <li><a href="/rest.li/testsuite_how_to">Test Suite</a></li>
                       
                         <li><a href="/rest.li/howto_add_new_language">Test Suite - Add New Language</a></li>
                       
                         <li><a href="/rest.li/user_guide/service_errors_java">Configure Service Errors in Java</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">FAQ</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Data-FAQ">Rest.li - FAQ</a></li>
                       
                         <li><a href="/rest.li/testsuite_troubleshooting">Test Suite - Troubleshooting</a></li>
                       
                        </ul>
                     </ul>
                        
                    </div>
                     <div class="markdown-body col s12 m3 l9">
                            <h1 id="restli-faq">Rest.li FAQ</h1>

<h2 id="how-do-i-validate-a-record-with-default-values-filled-in">How do I validate a record with default values filled in?</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Foo</span> <span class="n">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Foo</span><span class="o">();</span>  
<span class="nc">ValidationResult</span> <span class="n">result</span> <span class="o">=</span> <span class="nc">ValidateDataAgainstSchema</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">foo</span><span class="o">.</span><span class="na">data</span><span class="o">(),</span>
<span class="n">foo</span><span class="o">.</span><span class="na">schema</span><span class="o">(),</span> <span class="k">new</span>
<span class="nc">ValidationOptions</span><span class="o">(</span><span class="nc">RequiredMode</span><span class="o">.</span><span class="na">FIXUP_ABSENT_WITH_DEFAULT</span><span class="o">));</span>  
<span class="k">assert</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">isValid</span><span class="o">());</span>  
</code></pre></div></div>

<p>This will fail if the underlying data is read-only and default values
cannot be set for absent fields.</p>

<p>This will also work for partially filled in records. It will only add
default values to fields that are absent.</p>

<h2 id="how-do-i-convert-a-pegasus-data-schema-to-an-avro-data-schema">How do I convert a Pegasus data schema to an Avro data schema?</h2>

<p>It requires the data-avro module, or data-avro-*.jar.</p>

<p>At runtime, use:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Foo</span> <span class="n">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Foo</span><span class="o">();</span>  
<span class="nc">DataSchema</span> <span class="n">pegasusSchema</span> <span class="o">=</span> <span class="n">foo</span><span class="o">.</span><span class="na">schema</span><span class="o">();</span>  
<span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">avro</span><span class="o">.</span><span class="na">Schema</span> <span class="n">avroSchema</span> <span class="o">=</span>
<span class="nc">SchemaTranslator</span><span class="o">.</span><span class="na">dataToAvroSchema</span><span class="o">(</span><span class="n">pegasusSchema</span><span class="o">);</span>  
<span class="nc">String</span> <span class="n">avsoSchemaInJson</span> <span class="o">=</span> <span class="n">avroSchema</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>  
</code></pre></div></div>

<p>From the command line, to create text files with Avro schema from PDSC
files (version 0.17.1 or higher):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># syntax:
# java [-Dgenerator.resolver.path=&lt;path&gt;] com.linkedin.data.avro.AvroSchemaGenerator &lt;targetDir&gt; [&lt;pdscFile|schemaFullName&gt;]...
java -Dgenerator.resolver.path=src/main/pegasus com.linkedin.data.avro.generator.AvroSchemaGenerator ../build/main/codegen/avro src/main/pegasus/com/linkedin/foo/*.pdsc
# or
java -Dgenerator.resolver.path=src/main/pegasus com.linkedin.data.avro.generator.AvroSchemaGenerator ../build/main/codegen/avro com.linkedin.foo.Foo
</code></pre></div></div>

<p>Classpath must be setup to include <code class="highlighter-rouge">data-avro.jar</code> and its dependencies.</p>

<h2 id="how-do-i-use-a-data-type-embedded-inside-a-data-schema-file">How do I use a data type embedded inside a data schema file?</h2>

<p>You may experience errors, such as the
    following:</p>

<p><code class="highlighter-rouge">Type cannot be resolved: 1,1: "a.b.D" cannot be resolved.</code></p>

<p>when <code class="highlighter-rouge">a.b.D</code>’s definition is embedded in another type, for
example, <code class="highlighter-rouge">a.b.C</code>.</p>

<p>Embedded data types do not have their own data schema file. As a result, such
data types can only be referenced within the containing data schema file; it can
not be referenced externally. To change this behavior, pull out the
definition of the internal type to a separate data schema file.</p>

<p>Internally, this behavior is due to reason that the schema parser
references the data types by filenames. The schema file for <code class="highlighter-rouge">a.b.C</code>
is expected to be found at <code class="highlighter-rouge">pegasus/a/b/C.pdl</code>. Since Rest.li
does not prefix the containing data type’s name to the embedded type’s
name, when type <code class="highlighter-rouge">a.b.D</code> is embedded inside <code class="highlighter-rouge">C.pdl</code>, the
schema parser will not be able to find <code class="highlighter-rouge">pegasus/a/b/D.pdl</code>.</p>

<h2 id="why-is-my-java-8-build-generating-all-sorts-of-javadoc-warningserrors-due-to-doclint">Why is my Java 8 build generating all sorts of Javadoc warnings/errors due to doclint?</h2>

<p>When using Java 8, you may experience build failures due to the
following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[error] /home/myuser/data-template/src/main/codegen/com/linkedin/PegasusFormSchema.java:192: error: malformed HTML
* return type: java.util.Set&lt;java.lang.Integer&gt;
[error] /home/myuser/data-template/src/main/codegen/com/linkedin/PegasusFormSchema.java:192: error: bad use of '&gt;'
* return type: java.util.Set&lt;java.lang.Integer&gt;
</code></pre></div></div>

<p>The root cause is incorrectly formatted string values for anything
within the <code class="highlighter-rouge">doc</code> or <code class="highlighter-rouge">symbolDocs</code> (in <code class="highlighter-rouge">.pdsc</code> files) attributes within your data schemas. Due to
the addition of doclint in JDK8, anything under the doc or symbolDocs
attribute must be W3C HTML 4.01 compliant. This is because the contents
of this string will appear as Javadocs in the generated Java ‘data
template’ classes later. Please take this into consideration when
writing your documentation.</p>

<p>The alternative is to disable doclint altogether:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (JavaVersion.current().isJava8Compatible()) {
  allprojects {
    tasks.withType(Javadoc) {
      options.addStringOption('Xdoclint:none', '-quiet')
    }
  }
}
</code></pre></div></div>

<p>More details on doclint can be found here: <a href="http://stackoverflow.com/questions/22528767/jdk8-and-javadoc-has-become-very-strict">Javadoc has become very
strict</a></p>

<p>More details on <code class="highlighter-rouge">doc</code> and <code class="highlighter-rouge">symbolDocs</code> are at <a href="/rest.li/pdl_schema">Data Schemas</a>.</p>

<h2 id="how-does-restli-full-update-method-work-with-schema-evolution">How does Rest.li full update method work with schema evolution?</h2>

<p>There is a potential pitfall to be aware of. Consider the following
scenario:</p>

<ol>
  <li>Suppose a schema begins on version 0 with a single optional field A.
We write a client that sends an update request with the field A
populated.</li>
  <li>At some point, we add an optional field B in version 1.</li>
  <li>Our old client still sends a request with A populated, but it is not
clear how to interpret its request. From the server’s perspective,
we cannot distinguish a new client that wants to null out field B
(e.g. schema version 1) vs. a client that is not aware of field B
(e.g. version 0).</li>
</ol>

                     </div>
                   </div>
</div>



      <footer class="page-footer">
    <div class="container">
      <div class="row">
        <div class="col s6">
          <h5>Rest.li</h5>
          <p class="text-lighten-4">Rest.li is an open source REST framework for building robust, scalable RESTful architectures using type-safe bindings and asynchronous, non-blocking IO. Rest.li fills a niche for applying RESTful principles at scale with an end-to-end developer workflow for building REST APIs, which promotes clean REST practices, uniform interface design and consistent data modeling.</p>
        </div>
        <div class="col s5 offset-s1">
          <h5 class="black-text">Community</h5>
          <ul>
              <li>GitHub <a class="" href="https://github.com/linkedin/rest.li">Rest.li</a></li>
              <li>LinkedIn <a class="" href="https://www.linkedin.com/groups/4855943/">Rest.li Group</a></li>
            <li>Follow us on twitter: <a class="" href="https://twitter.com/rest_li"> @rest_li</a></li>
            <li>Issue Tracking: <a class="" href="https://github.com/linkedin/rest.li/issues">GitHub issue tracking</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
        <div class="container">
            <div class="row">
              <div class="col s6">
                      Copyright 2018 LinkedIn Corporation </br>
                      This work is licensed under a <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.  </br>
                      For clarity, no trademark is licensed.
                      </br></br>
              </div>
              <div class="col s5 offset-s1">
                      This work was made by using Jekyll (and a Jekyll Starter Template)</br>
                      <a target="_blank" href="https://github.com/macrod68/jekyll-materialize-starter-template">https://github.com/macrod68/jekyll-materialize-starter-template</a></br>
                      Copyright © 2017 Marco Damiani. Powered by <a target="_blank" href="http://jekyllrb.com/">Jekyll</a></br>
                      License:<a target="_blank" href="https://opensource.org/licenses/MIT">MIT</a>
              </div>
            </div>
        </div>
    </div>
    <script>
      $(function() {
        return $("h2, h3, h4, h5, h6").each(function(i, el) {
          var $el, icon, id;
          $el = $(el);
          id = $el.attr('id');
          icon = '<i class="fa fa-link"></i>';
          if (id) {
            return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
          }
        });
      });
      </script>
</footer>

      
    <!--  Scripts-->                                                                               
<script src="/rest.li/assets/js/jquery.min.js"></script>
<script src="/rest.li/assets/js/materialize.min.js"></script>
<script src="/rest.li/assets/js/init.js"></script>

  </body>

</html>
