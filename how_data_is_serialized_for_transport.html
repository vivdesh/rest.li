<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128576866-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-128576866-1');
    </script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>

    <title>How Data is Serialized for Transport</title>
    <meta name="description" content="Rest.li how data is serialized for transport." />

    <link rel="icon" type="image/png" href="/rest.li/assets/images/icon_pegasus.png">
  
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" media="screen,projection" href="/rest.li/assets/css/main.css">
    <link rel="canonical" href="/rest.li/how_data_is_serialized_for_transport" />
    <link rel="alternate" type="application/rss+xml" title="rest.li" href="/rest.li/feed.xml" />

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <script src="//code.jquery.com/jquery-3.0.0.min.js"></script>
    <script src="/rest.li/assets/js/search-input.js"></script>
    

    
    <script>
       $(function() {
          $("h1").addClass("no_toc");
       });
    </script>
</head>


  <body>

    <nav class="dark-grey" role="navigation">
    <div class="nav-wrapper container"><a id="logo-container" class="brand-logo" href="/rest.li/">Rest.li</a>
      <ul class="right hide-on-med-and-down">
        
        <li>
          <a href="/rest.li/get_started/quick_start" >
            Getting Started
          </a>
        </li>
        
        <li>
          <a href="/rest.li/user_guide/server_architecture" >
            User Guide
          </a>
        </li>
        
        <li>
          <a href="/rest.li/spec/protocol" >
            API Reference
          </a>
        </li>
        
        <li>
          <a href="/rest.li/contribute/howto" >
            Contribute
          </a>
        </li>
        
          <li>
            <div class="center row" >
              <div class="col s12 ">
                <div class="row">
                  <div class="input-field col s6 s12 min">
                      <i id="search-txt" class="material-icons prefix">search</i>
                      <input type="text" id="search-input">
                    </div>
                  </div>
                </div>
              </div>
          </li>
          <li>
              <a id="github-menu" href="http://github.com/linkedin/rest.li/" >
                   <i class="fa fa-github"></i>
                </a>
          </li>
          </ul>
      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
</nav>



        <div class="container">
        <div class="row">
                <div class="col s12 m4 l3"> 
               
                    
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">User Guide</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/user_guide/server_architecture">Rest.li Architecture</a></li>
                       
                         <li><a href="/rest.li/user_guide/restli_server">Rest.li Server</a></li>
                       
                         <li><a href="/rest.li/user_guide/restli_client">Rest.li Client Framework</a></li>
                       
                         <li><a href="/rest.li/user_guide/unstructured_data">Unstructured Data</a></li>
                       
                         <li><a href="/rest.li/Components">Components</a></li>
                       
                         <li><a href="/rest.li/Asynchronous-Servers-and-Clients-in-Rest_li">Asynchronous in Rest.li</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Data Schemas</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/pdl_schema">PDL Schema</a></li>
                       
                         <li><a href="/rest.li/pdsc_syntax">PDSC Syntax</a></li>
                       
                         <li><a href="/rest.li/pdl_migration">Migrating from PDSC to PDL</a></li>
                       
                         <li><a href="/rest.li/avro_translation">Avro Translation</a></li>
                       
                         <li><a href="/rest.li/java_binding">Java Binding</a></li>
                       
                         <li><a href="/rest.li/annotation_processor">Schema Annotation Processor</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Modeling Resources</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/modeling/modeling">Modeling Resources</a></li>
                       
                         <li><a href="/rest.li/modeling/compatibility_check">Snapshots and Resource Compatibility Checking</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Data</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/how_data_is_serialized_for_transport">How Data is Serialized for Transport</a></li>
                       
                         <li><a href="/rest.li/how_data_is_represented_in_memory">How Data is Represented in Memory</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Main concepts</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Rest_li-Filters">Filters</a></li>
                       
                         <li><a href="/rest.li/Projections">Projections</a></li>
                       
                         <li><a href="/rest.li/pathspec">PathSpecs</a></li>
                       
                         <li><a href="/rest.li/Validation-in-Rest_li">Validation</a></li>
                       
                         <li><a href="/rest.li/Attachment-Streaming">Attachment Streaming</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Mutli-language</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/multi_language_compatibility_matrix">Compatibility Matrix</a></li>
                       
                         <li><a href="/rest.li/test_suite">Test Suite</a></li>
                       
                         <li><a href="https://github.com/mchen07/restli-csharp">C#</a></li>
                       
                         <li><a href="/rest.li/Scala-Integration">Scala Integration</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Testing</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Writing-unit-tests-for-Rest_li-clients-and-servers">Writing Unit Tests</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">How to</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Send-Rest_li-Request-Query-In-Request-Body">Send Request Query in the Body</a></li>
                       
                         <li><a href="/rest.li/How-to-use-projections-in-Java">Use Projections</a></li>
                       
                         <li><a href="/rest.li/Rest_li_Avro_conversions">Avro Conversion</a></li>
                       
                         <li><a href="/rest.li/Compression">Compression</a></li>
                       
                         <li><a href="/rest.li/Rest_li-2_x-upgrade-instructions">Migrate to Rest.li 2.x</a></li>
                       
                         <li><a href="/rest.li/testsuite_how_to">Test Suite</a></li>
                       
                         <li><a href="/rest.li/howto_add_new_language">Test Suite - Add New Language</a></li>
                       
                         <li><a href="/rest.li/user_guide/service_errors_java">Configure Service Errors in Java</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">FAQ</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Data-FAQ">Rest.li - FAQ</a></li>
                       
                         <li><a href="/rest.li/testsuite_troubleshooting">Test Suite - Troubleshooting</a></li>
                       
                        </ul>
                     </ul>
                        
                    </div>
                     <div class="markdown-body col s12 m3 l9">
                            <h1 id="how-data-is-serialized-for-transport">How Data is Serialized for Transport</h1>

<p>The data is serialized for transport using JSON encoding in following
the Avro 1.4.1 specification. This JSON encoding is also the same as the
JSON expression used to describe default values.</p>

<p><strong>One notable difference from the Avro spec is that optional fields with
no value are represented by its omission in the serialized data. To
phrase it differently, optional fields are never explicitly set to
<code class="highlighter-rouge">null</code> in the serialized body.</strong> As such, <code class="highlighter-rouge">null</code> is never a valid value
to appear in the serialized data. The only exception to this rule is if
the schema for the data is a union that has a <code class="highlighter-rouge">null</code> member.</p>

<p>The following table summarizes the JSON encoding.</p>

<table>
<thead>
<tr class="header">
<th>Schema Type <br /></th>
<th>JSON Type <br /></th>
<th>JSON Encoding Examples <br /></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>int <br /></td>
<td>number <br /></td>
<td>123 <br /></td>
</tr>
<tr class="even">
<td>long <br /></td>
<td>number <br /></td>
<td>123456789000 <br /></td>
</tr>
<tr class="odd">
<td>float <br /></td>
<td>number <br /></td>
<td>3.5 <br /></td>
</tr>
<tr class="even">
<td>double <br /></td>
<td>number <br /></td>
<td>3.5555555 <br /></td>
</tr>
<tr class="odd">
<td>boolean <br /></td>
<td>true or false <br /></td>
<td>true <br /></td>
</tr>
<tr class="even">
<td>string <br /></td>
<td>string <br /></td>
<td>“hello” <br /></td>
</tr>
<tr class="odd">
<td>bytes <br /></td>
<td>string (bytes encoded as least significant 8-bits of 16-bit character) <br /></td>
<td>“\u00ba\u00db\u00ad” <br /></td>
</tr>
<tr class="even">
<td>enum <br /></td>
<td>string <br /></td>
<td>“APPLE” <br /></td>
</tr>
<tr class="odd">
<td>fixed <br /></td>
<td>string (bytes encoded as least significant 8-bits of 16-bit character)</td>
<td>“\u0001\u0002\u0003\u0004” (fixed of size 4) <br /></td>
</tr>
<tr class="even">
<td>array <br /></td>
<td>array <br /></td>
<td>[ 1, 2, 3 ] <br /></td>
</tr>
<tr class="odd">
<td>map <br /></td>
<td>object <br /></td>
<td>{ “a” : 95, “b” : 90, “c” : 85 } <br /></td>
</tr>
<tr class="even">
<td>record (error) <br /></td>
<td>object (each field is encoded using a name/value pair in the object) <br /></td>
<td>{ “intField” : 1, “stringField” : “abc”, “fruitsField” : “APPLE” }</td>
</tr>
<tr class="odd">
<td>union <br /></td>
<td>null if value is null. <br /><br />
object if member value is not null with only one name/value pair in the object. The name will be the member discriminator (<strong>NOTE Member discriminator will be the member’s alias if one is specified, else it is the member’s fully qualified type name.</strong>) and value is the JSON encoded value. <br /></td>
<td>null <br /><br />
{ “int” : 1 } <br /><br />
{ “float” : 3.5 } <br /><br />
{ “string” : “abc” } <br /><br />
{ “array” : { “s1”, “s2”, “s3” } } <br /><br />
{ “map” : { “key1” : 10, “key2” : 20, “key3” : 30 } } <br /><br />
{ “com.linkedin.generator.examples.Fruits” : “APPLE” }</td>
</tr>
</tbody>
</table>

<p>If a union schema has a typeref member, then the key for that member is
the dereferenced type. E.g. for union</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  {
    "name" : "unionField",
    "type" : [
      "int",
      { "type" : "typeref", "name" : "a.b.c.d.Foo", "ref"  : "string" }
    ]
  }
</code></pre></div></div>

<p>the JSON encoding for the typeref member should look like</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ “string” : “Correct key” }
</code></pre></div></div>

<p>NOT</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ “a.b.c.d.Foo” : “Wrong key” }
</code></pre></div></div>

<p>Similarly, for a union with aliased members the key for the members will
be its corresponding alias. For example,</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"unionField"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="nl">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"int"</span><span class="p">,</span><span class="w"> </span><span class="nl">"alias"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"count"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="nl">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"typeref"</span><span class="p">,</span><span class="w"> </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"a.b.c.d.Foo"</span><span class="p">,</span><span class="w"> </span><span class="nl">"ref"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nl">"alias"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"foo"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>the JSON encoding for the typeref member should look like</p>

<p><code class="highlighter-rouge">{ “foo” : “Correct key” }</code></p>

<h4 id="how-to-serialize-data-to-json">How to serialize data to JSON</h4>

<p><code class="highlighter-rouge">DataMapUtils</code> provides convenience methods to serialize and deserialize
between data and JSON using <code class="highlighter-rouge">JacksonDataCodec</code>.</p>

<p>To serialize from a DataMap to JSON:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DataMap</span> <span class="n">dataMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataMap</span><span class="o">();</span>
<span class="n">dataMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"message"</span><span class="o">,</span> <span class="s">"Hi!"</span><span class="o">);</span>
<span class="kt">byte</span><span class="o">[]</span> <span class="n">jsonBytes</span> <span class="o">=</span> <span class="nc">DataMapUtils</span><span class="o">.</span><span class="na">mapToBytes</span><span class="o">(</span><span class="n">dataMap</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">jsonBytes</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">);</span>

</code></pre></div></div>

<p>To serialize from a RecordTemplate instance to JSON:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Greeting</span> <span class="n">greeting</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Greeting</span><span class="o">().</span><span class="na">setMessage</span><span class="o">(</span><span class="s">"Hi!"</span><span class="o">);</span> <span class="c1">// Where Greeting is class extending RecordTemplate</span>
<span class="kt">byte</span><span class="o">[]</span> <span class="n">jsonBytes</span> <span class="o">=</span> <span class="nc">DataMapUtils</span><span class="o">.</span><span class="na">dataTemplateToBytes</span><span class="o">(</span><span class="n">greeting</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">jsonBytes</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">);</span>
</code></pre></div></div>

<h4 id="how-to-deserialize-json-to-data">How to Deserialize JSON to Data</h4>

<p>To deserialize from JSON to a DataMap:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="nc">IOUtils</span><span class="o">.</span><span class="na">toInputStream</span><span class="o">(</span><span class="s">"{'message':'Hi!'}"</span><span class="o">);</span>
<span class="nc">DataMap</span> <span class="n">dataMap</span> <span class="o">=</span> <span class="nc">DataMapUtils</span><span class="o">.</span><span class="na">readMap</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>
</code></pre></div></div>

<p>To deserialize from JSON to a RecordTemplate:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="nc">IOUtils</span><span class="o">.</span><span class="na">toInputStream</span><span class="o">(</span><span class="s">"{'message':'Hi!'}"</span><span class="o">);</span>
<span class="nc">Greeting</span> <span class="n">deserialized</span> <span class="o">=</span> <span class="nc">DataMapUtils</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">in</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">.</span><span class="na">class</span><span class="o">);</span> <span class="c1">// Where Greeting is class extending RecordTemplate</span>
</code></pre></div></div>

<h4 id="how-to-serialize-data-to-pson">How to Serialize Data to PSON</h4>

<p>PSON is a binary format that can represent any JSON data but is more
compact, requires less computation to serialize and deserialize, and can
transmit byte strings directly.</p>

<p>PSON serialization/deserialization works similar to JSON (as described
above) but uses these two methods:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DataMapUtils</span><span class="o">.</span><span class="na">readMapPson</span><span class="o">()</span>
<span class="nc">DataMapUtils</span><span class="o">.</span><span class="na">mapToPsonBytes</span><span class="o">()</span>
</code></pre></div></div>

                     </div>
                   </div>
</div>



      <footer class="page-footer">
    <div class="container">
      <div class="row">
        <div class="col s6">
          <h5>Rest.li</h5>
          <p class="text-lighten-4">Rest.li is an open source REST framework for building robust, scalable RESTful architectures using type-safe bindings and asynchronous, non-blocking IO. Rest.li fills a niche for applying RESTful principles at scale with an end-to-end developer workflow for building REST APIs, which promotes clean REST practices, uniform interface design and consistent data modeling.</p>
        </div>
        <div class="col s5 offset-s1">
          <h5 class="black-text">Community</h5>
          <ul>
              <li>GitHub <a class="" href="https://github.com/linkedin/rest.li">Rest.li</a></li>
              <li>LinkedIn <a class="" href="https://www.linkedin.com/groups/4855943/">Rest.li Group</a></li>
            <li>Follow us on twitter: <a class="" href="https://twitter.com/rest_li"> @rest_li</a></li>
            <li>Issue Tracking: <a class="" href="https://github.com/linkedin/rest.li/issues">GitHub issue tracking</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
        <div class="container">
            <div class="row">
              <div class="col s6">
                      Copyright 2018 LinkedIn Corporation </br>
                      This work is licensed under a <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.  </br>
                      For clarity, no trademark is licensed.
                      </br></br>
              </div>
              <div class="col s5 offset-s1">
                      This work was made by using Jekyll (and a Jekyll Starter Template)</br>
                      <a target="_blank" href="https://github.com/macrod68/jekyll-materialize-starter-template">https://github.com/macrod68/jekyll-materialize-starter-template</a></br>
                      Copyright © 2017 Marco Damiani. Powered by <a target="_blank" href="http://jekyllrb.com/">Jekyll</a></br>
                      License:<a target="_blank" href="https://opensource.org/licenses/MIT">MIT</a>
              </div>
            </div>
        </div>
    </div>
    <script>
      $(function() {
        return $("h2, h3, h4, h5, h6").each(function(i, el) {
          var $el, icon, id;
          $el = $(el);
          id = $el.attr('id');
          icon = '<i class="fa fa-link"></i>';
          if (id) {
            return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
          }
        });
      });
      </script>
</footer>

      
    <!--  Scripts-->                                                                               
<script src="/rest.li/assets/js/jquery.min.js"></script>
<script src="/rest.li/assets/js/materialize.min.js"></script>
<script src="/rest.li/assets/js/init.js"></script>

  </body>

</html>
