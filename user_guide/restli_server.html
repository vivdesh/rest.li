<!DOCTYPE html>
<html lang="en">

  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128576866-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-128576866-1');
    </script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>

    <title>Rest.li server user guide</title>
    <meta name="description" content="This document describes Rest.li support for implementing servers." />

    <link rel="icon" type="image/png" href="/rest.li/assets/images/icon_pegasus.png">
  
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" media="screen,projection" href="/rest.li/assets/css/main.css">
    <link rel="canonical" href="/rest.li/user_guide/restli_server" />
    <link rel="alternate" type="application/rss+xml" title="rest.li" href="/rest.li/feed.xml" />

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <script src="//code.jquery.com/jquery-3.0.0.min.js"></script>
    <script src="/rest.li/assets/js/search-input.js"></script>
    

    
    <script>
       $(function() {
          $("h1").addClass("no_toc");
       });
    </script>
</head>


  <body>

    <nav class="dark-grey" role="navigation">
    <div class="nav-wrapper container"><a id="logo-container" class="brand-logo" href="/rest.li/">Rest.li</a>
      <ul class="right hide-on-med-and-down">
        
        <li>
          <a href="/rest.li/get_started/quick_start" >
            Getting Started
          </a>
        </li>
        
        <li>
          <a href="/rest.li/user_guide/server_architecture" >
            User Guide
          </a>
        </li>
        
        <li>
          <a href="/rest.li/spec/protocol" >
            API Reference
          </a>
        </li>
        
        <li>
          <a href="/rest.li/contribute/howto" >
            Contribute
          </a>
        </li>
        
          <li>
            <div class="center row" >
              <div class="col s12 ">
                <div class="row">
                  <div class="input-field col s6 s12 min">
                      <i id="search-txt" class="material-icons prefix">search</i>
                      <input type="text" id="search-input">
                    </div>
                  </div>
                </div>
              </div>
          </li>
          <li>
              <a id="github-menu" href="http://github.com/linkedin/rest.li/" >
                   <i class="fa fa-github"></i>
                </a>
          </li>
          </ul>
      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
</nav>



        <div class="container">
        <div class="row">
                <div class="col s12 m4 l3"> 
               
                    
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">User Guide</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/user_guide/server_architecture">Rest.li Architecture</a></li>
                       
                         <li><a href="/rest.li/user_guide/restli_server">Rest.li Server</a></li>
                       
                         <li><a href="/rest.li/user_guide/restli_client">Rest.li Client Framework</a></li>
                       
                         <li><a href="/rest.li/user_guide/unstructured_data">Unstructured Data</a></li>
                       
                         <li><a href="/rest.li/Components">Components</a></li>
                       
                         <li><a href="/rest.li/Asynchronous-Servers-and-Clients-in-Rest_li">Asynchronous in Rest.li</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Data Schemas</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/pdl_schema">PDL Schema</a></li>
                       
                         <li><a href="/rest.li/pdsc_syntax">PDSC Syntax</a></li>
                       
                         <li><a href="/rest.li/pdl_migration">Migrating from PDSC to PDL</a></li>
                       
                         <li><a href="/rest.li/avro_translation">Avro Translation</a></li>
                       
                         <li><a href="/rest.li/java_binding">Java Binding</a></li>
                       
                         <li><a href="/rest.li/annotation_processor">Schema Annotation Processor</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Modeling Resources</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/modeling/modeling">Modeling Resources</a></li>
                       
                         <li><a href="/rest.li/modeling/compatibility_check">Snapshots and Resource Compatibility Checking</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Data</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/how_data_is_serialized_for_transport">How Data is Serialized for Transport</a></li>
                       
                         <li><a href="/rest.li/how_data_is_represented_in_memory">How Data is Represented in Memory</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Main concepts</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Rest_li-Filters">Filters</a></li>
                       
                         <li><a href="/rest.li/Projections">Projections</a></li>
                       
                         <li><a href="/rest.li/pathspec">PathSpecs</a></li>
                       
                         <li><a href="/rest.li/Validation-in-Rest_li">Validation</a></li>
                       
                         <li><a href="/rest.li/Attachment-Streaming">Attachment Streaming</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Mutli-language</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/multi_language_compatibility_matrix">Compatibility Matrix</a></li>
                       
                         <li><a href="/rest.li/test_suite">Test Suite</a></li>
                       
                         <li><a href="https://github.com/mchen07/restli-csharp">C#</a></li>
                       
                         <li><a href="/rest.li/Scala-Integration">Scala Integration</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Testing</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Writing-unit-tests-for-Rest_li-clients-and-servers">Writing Unit Tests</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">How to</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Send-Rest_li-Request-Query-In-Request-Body">Send Request Query in the Body</a></li>
                       
                         <li><a href="/rest.li/How-to-use-projections-in-Java">Use Projections</a></li>
                       
                         <li><a href="/rest.li/Rest_li_Avro_conversions">Avro Conversion</a></li>
                       
                         <li><a href="/rest.li/Compression">Compression</a></li>
                       
                         <li><a href="/rest.li/Rest_li-2_x-upgrade-instructions">Migrate to Rest.li 2.x</a></li>
                       
                         <li><a href="/rest.li/testsuite_how_to">Test Suite</a></li>
                       
                         <li><a href="/rest.li/howto_add_new_language">Test Suite - Add New Language</a></li>
                       
                         <li><a href="/rest.li/user_guide/service_errors_java">Configure Service Errors in Java</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">FAQ</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Data-FAQ">Rest.li - FAQ</a></li>
                       
                         <li><a href="/rest.li/testsuite_troubleshooting">Test Suite - Troubleshooting</a></li>
                       
                        </ul>
                     </ul>
                        
                    </div>
                     <div class="markdown-body col s12 m3 l9">
                            <h1 id="restli-server-user-guide">Rest.li Server User Guide</h1>

<h2 id="contents">Contents</h2>

<ul>
  <li><a href="#runtimes">Runtimes</a></li>
  <li><a href="#r2-filter-configuration">R2 Filter Configuration</a></li>
  <li><a href="#defining-data-models">Defining Data Models</a></li>
  <li><a href="#writing-resources">Writing Resources</a></li>
  <li><a href="#documenting-resources">Documenting Resources</a></li>
  <li><a href="#resource-annotations">Resource Annotations</a></li>
  <li><a href="#asynchronous-resources">Asynchronous Resources</a></li>
  <li><a href="#sub-resources">Sub-Resources</a></li>
  <li><a href="#resource-methods">Resource Methods</a>
    <ul>
      <li><a href="#get">Get</a></li>
      <li><a href="#batch_get">Batch Get</a></li>
      <li><a href="#get_all">Get All</a></li>
      <li><a href="#finder">Finder</a></li>
      <li><a href="#batch-finder">Batch Finder</a></li>
      <li><a href="#create">Create</a></li>
      <li><a href="#batch_create">Batch Create</a></li>
      <li><a href="#update">Update</a></li>
      <li><a href="#batch_update">Batch Update</a></li>
      <li><a href="#partial_update">Partial Update</a></li>
      <li><a href="#batch_partial_update">Batch Partial Update</a></li>
      <li><a href="#delete">Delete</a></li>
      <li><a href="#batch_delete">Batch Delete</a></li>
      <li><a href="#action">Action</a></li>
    </ul>
  </li>
  <li><a href="#resourcecontext">ResourceContext</a></li>
  <li><a href="#resource-templates">Resource Templates</a></li>
  <li><a href="#free-form-resources">Free-form Resources</a></li>
  <li><a href="#returning-errors">Returning Errors</a></li>
  <li><a href="#field-projection">Field Projection</a></li>
  <li><a href="#collection-pagination">Collection Pagination</a></li>
  <li><a href="#dependency-injection">Dependency Injection</a></li>
  <li><a href="#online-documentation">Online Documentation</a></li>
</ul>

<p>This document describes Rest.li support for implementing servers.</p>

<h2 id="runtimes">Runtimes</h2>

<p>Rest.li supports the following runtimes:</p>

<ol>
  <li><a href="/rest.li/Rest_li-with-Servlet-Containers">Servlet containers</a> (for example, Jetty)</li>
  <li><a href="/rest.li/Rest_li-with-Netty">Netty</a></li>
</ol>

<h2 id="r2-filter-configuration">R2 Filter Configuration</h2>

<p>Rest.li servers can be configured with different R2 filters, according
to your use case. How the filters are configured depends on which
dependency injection framework (if any) you are using. For example, see <a href="/rest.li/Compression">Compression</a> to understand how to configure a server for
compression. Another example is to add a
<code class="highlighter-rouge">SimpleLoggingFilter</code> with Spring, which requires you to do
the following (full file
<a href="https://github.com/linkedin/rest.li/blob/master/examples/spring-server/server/src/main/webapp/WEB-INF/beans.xml">here</a>):</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Example of how to add filters; here we'll enable logging and snappy compression support --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"loggingFilter"</span> <span class="na">class=</span><span class="s">"com.linkedin.r2.filter.logging.SimpleLoggingFilter"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p><a href="https://github.com/linkedin/rest.li/tree/master/r2-core/src/main/java/com/linkedin/r2/filter">Other R2 filters</a>
can also be configured in a similar way.</p>

<p><a id="wiki-DefiningDataModels"></a></p>

<h2 id="defining-data-models">Defining Data Models</h2>

<p>The first step in building a Rest.li application is to define your data
schema using <a href="/rest.li/pdl_schema">Pegasus Data Schemas</a>. The
Pegasus Data Schema format uses a simple Avro-like syntax to define your
data model in a language-independent way. Rest.li provides code
generators to create Java classes that implement your data model.</p>

<p><a id="wiki-WritingResources"></a></p>

<h2 id="writing-resources">Writing Resources</h2>

<p>After you have defined your data models, the principle programming task
when implementing a Rest.li server is to create resource classes. In
Rest.li, resource classes define the RESTful endpoints your server
provides. You create a resource class by adding a class level annotation
and by implementing or extending a Rest.li interface or base class
corresponding to the annotation. The annotations help describe the
mapping from your Java code to the REST interface protocol. When
possible, the framework uses conventions to help minimize the
annotations you need to write.</p>

<p>Steps to define a resource class:</p>

<ul>
  <li>The class must have the default constructor. The default constructor
will be used by Rest.li to instantiate the resource class for each
request execution.</li>
  <li>The class must be annotated with one of the Resource Annotations.</li>
  <li>If required by the annotation, the class must <code class="highlighter-rouge">implement</code> the
necessary Resource interface or extend one of the convenience base
classes that implements the interface.</li>
  <li>To expose methods on the resource, each method must either:
    <ul>
      <li>Override a standard method from the Resource interface</li>
      <li>Include the necessary method-level annotation as described in
the Resource Methods section below</li>
    </ul>
  </li>
  <li>For each exposed method, each parameter must either:
    <ul>
      <li>Be part of the standard signature, for overridden methods</li>
      <li>Be annotated with one of the parameter-level annotations
described for the Resource Method.</li>
    </ul>
  </li>
  <li>All documentation is written in the resource source file using
javadoc (or scaladoc, see below for details).</li>
</ul>

<p>Here is a simple example of a Resource class. It extends a convenience
base class, uses an annotation to define a REST end-point (“fortunes”),
and provides a GET endpoint by overriding the standard signature of the
<code class="highlighter-rouge">get()</code> method of the base class:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * A collection of fortunes, keyed by random number.
 */</span>
<span class="nd">@RestLiCollection</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"fortunes"</span><span class="o">,</span> <span class="n">namespace</span> <span class="o">=</span> <span class="s">"com.example.fortune"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FortunesResource</span> <span class="kd">extends</span> <span class="nc">CollectionResourceTemplate</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Fortune</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="cm">/**
   * Gets a fortune for a random number.
   */</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">Fortune</span> <span class="nf">get</span><span class="o">(</span><span class="nc">Long</span> <span class="n">key</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="c1">// retrieve data and return a Fortune object ...</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This interface implements an HTTP GET:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; GET /fortunes/1
...
&lt; { "fortune": "Your lucky color is purple" }
</code></pre></div></div>

<p>Note that Rest.li does not automatically use the names of your Java
identifiers. Class names, method names, and parameter names have no
direct bearing on the interface your resource exposes through
annotations.</p>

<p>The above example supports the GET operation by overriding the
<code class="highlighter-rouge">CollectionResourceTemplate</code>, and you can also choose to support other
operations by overriding other methods. However, you can also define any
method of your class as handling operations by using Resource
Annotations, described in detail in the next section.</p>

<p><a id="wiki-DocumentingResources"></a></p>

<h2 id="documenting-resources">Documenting Resources</h2>

<p>Rest.li resources are documented in the resource source files using
javadoc. When writing resources, developers simply add any documentation
as javadoc to their java resource classes, methods, and method params.
It is recommended that developers follow the <a href="http://www.oracle.com/technetwork/java/javase/documentation/index-137868.html">javadoc style
guidelines</a>
for all formatting so that their documentation is displayed correctly.</p>

<p>Rest.li will automatically extract this javadoc and include it in all
generated “interface definitions” (.restspec.json files) and generated
client bindings. This approach allows REST API clients and tools to
easily gain access to the documentation. For example, <a href="https://github.com/linkedin/rest.li-api-hub">Rest.li API
Hub</a> is an opensource web
UI that displays REST API documentation, including all javadoc, for
Rest.li APIs.</p>

<p><a id="wiki-ResourceAnnotations"></a></p>

<h2 id="resource-annotations">Resource Annotations</h2>

<p>Resource annotations are used to mark and register a class as providing
as Rest.li resource. One of a number of annotations may be used,
depending on the <a href="/rest.li/modeling/modeling#collection">Interface Pattern</a>
the resource is intended to implement. Briefly, here are the options:</p>

<p><a id="wiki-ResourceTypes"></a></p>

<table>
  <thead>
    <tr>
      <th>Resource Type</th>
      <th>Annotation</th>
      <th>Interface or Base Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Collection</td>
      <td>@RestLiCollection</td>
      <td>For simple keys, implement <code class="highlighter-rouge">CollectionResource</code> or extend <code class="highlighter-rouge">CollectionResourceTemplate</code>. For complex key implement <code class="highlighter-rouge">ComplexKeyResource</code>, extend <code class="highlighter-rouge">ComplexKeyResourceTemplate</code>, or implement <code class="highlighter-rouge">KeyValueResource</code> for use cases requiring extensive customization</td>
    </tr>
    <tr>
      <td>Simple</td>
      <td>@RestLiSimpleResource</td>
      <td>Implement <code class="highlighter-rouge">SimpleResource</code>, extend <code class="highlighter-rouge">SimpleResourceTemplate</code> or implement <code class="highlighter-rouge">SingleObjectResource</code> for use cases requiring extensive customization</td>
    </tr>
    <tr>
      <td>Association</td>
      <td>@RestLiAssociation</td>
      <td>Implement <code class="highlighter-rouge">AssociationResource</code>, extend <code class="highlighter-rouge">AssociationResourceTemplate</code>, or implement <code class="highlighter-rouge">KeyValueResource</code> for use cases requiring extensive customization</td>
    </tr>
    <tr>
      <td>Actions</td>
      <td>@RestLiActions</td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>

<h4 id="restlicollection">@RestLiCollection</h4>

<p>The <code class="highlighter-rouge">@RestLiCollection</code> annotation is applied to classes to mark them as
providing a Rest.li collection resource. Collection resources model a
collection of entities, where each entity is referenced by a key. See
<a href="/rest.li/modeling/modeling#collection">Collection Resource Pattern</a> for more details.</p>

<p>The supported annotation parameters are:</p>

<ul>
  <li><code class="highlighter-rouge">name</code> - required, defines the name of the resource.</li>
  <li><code class="highlighter-rouge">namespace</code> - optional, defines the namespace for the resource.
Default is empty (root namespace). The namespace of the resource
appears in the IDL, and is used as the package name for the
generated client builders.</li>
  <li><code class="highlighter-rouge">keyName</code> - optional, defines the key name for the resource. Default
is “&lt;ResourceName&gt;Id”.</li>
  <li><code class="highlighter-rouge">parent</code> - optional, defines the parent resource for this resource.
Default is root.</li>
</ul>

<p>Classes annotated with <code class="highlighter-rouge">@RestLiCollection</code> must implement the
<code class="highlighter-rouge">CollectionResource</code> interface. The <code class="highlighter-rouge">CollectionResource</code> interface
requires two generic type parameters:</p>

<ul>
  <li><code class="highlighter-rouge">K</code> - the key type for the resource.</li>
  <li><code class="highlighter-rouge">V</code> - the value type for the resource (also known as, the entity
type).</li>
</ul>

<p>The key type for a collection resource must be one of:</p>

<ul>
  <li><code class="highlighter-rouge">String</code></li>
  <li><code class="highlighter-rouge">Boolean</code></li>
  <li><code class="highlighter-rouge">Integer</code></li>
  <li><code class="highlighter-rouge">Long</code></li>
  <li>A Pegasus Enum (any enum defined in a <code class="highlighter-rouge">.pdl</code> schema)</li>
  <li>Custom Type (see below for details)</li>
  <li>Complex Key (A pegasus record, any subclass of <code class="highlighter-rouge">RecordTemplate</code>
generated from a <code class="highlighter-rouge">.pdl</code> schema)</li>
</ul>

<p>The value type for a collection resource must be a pegasus record, any
subclass of <code class="highlighter-rouge">RecordTemplate</code> generated from a <code class="highlighter-rouge">.pdl</code> schema.</p>

<p>For convenience, collection resources may extend
<code class="highlighter-rouge">CollectionResourceTemplate</code> rather than directly implementing the
<code class="highlighter-rouge">CollectionResource</code> interface.</p>

<p>Example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestLiCollection</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"fortunes"</span><span class="o">,</span> <span class="n">namespace</span> <span class="o">=</span> <span class="s">"com.example.fortune"</span><span class="o">,</span> <span class="n">keyName</span> <span class="o">=</span> <span class="s">"fortuneId"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FortunesResource</span> <span class="kd">extends</span> <span class="nc">CollectionResourceTemplate</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Fortune</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p><a id="wiki-AsynchResources"></a></p>

<h2 id="asynchronous-resources">Asynchronous Resources</h2>

<p>Rest.li allows resources to return results asynchronously through a
<a href="https://github.com/linkedin/parseq/wiki">ParSeq</a> <code class="highlighter-rouge">Task</code>, or
<code class="highlighter-rouge">Callback</code>. For example, a getter can be declared in either of the
following ways:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
<span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">get</span><span class="o">(</span><span class="nc">Long</span> <span class="n">key</span><span class="o">)</span>
<span class="o">{</span>
  <span class="c1">// set up some ParSeq tasks and return the final Task</span>
  <span class="k">return</span> <span class="nc">Tasks</span><span class="o">.</span><span class="na">seq</span><span class="o">(</span><span class="nc">Tasks</span><span class="o">.</span><span class="na">par</span><span class="o">(...),</span> <span class="o">...);</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">get</span><span class="o">(</span><span class="nc">Long</span> <span class="n">key</span><span class="o">,</span> <span class="nd">@CallbackParam</span> <span class="nc">Callback</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">callback</span><span class="o">)</span>
<span class="o">{</span>
  <span class="c1">// use the callback asynchronously</span>
<span class="o">}</span>
</code></pre></div></div>

<p>These method signatures can be mixed arbitrarily with the synchronous
signatures, including in the same resource class. For instance, simple
methods can be implemented synchronously and slow methods can be
implemented asynchronously. However, multiple implementations of the
same REST method with different signatures may <strong>not</strong> be provided.</p>

<p>You can also use the asynchronous resource templates in order to
implement asynchronous Rest.li resources. The templates are:</p>

<ul>
  <li><code class="highlighter-rouge">AssociationResourceAsyncTemplate</code></li>
  <li><code class="highlighter-rouge">AssociationResourceTaskTemplate</code></li>
  <li><code class="highlighter-rouge">CollectionResourceAsyncTemplate</code></li>
  <li><code class="highlighter-rouge">CollectionResourceTaskTemplate</code></li>
  <li><code class="highlighter-rouge">ComplexKeyResourceAsyncTemplate</code></li>
  <li><code class="highlighter-rouge">ComplexKeyResourceTaskTemplate</code></li>
  <li><code class="highlighter-rouge">SimpleResourceAsyncTemplate</code></li>
  <li><code class="highlighter-rouge">SimpleResourceTaskTemplate</code></li>
</ul>

<p>The Rest.li server will automatically start any <code class="highlighter-rouge">Task</code> that is returned
by a <code class="highlighter-rouge">Task</code> based method by running it through a ParSeq engine. This ParSeq engine is launched while the Rest.Li server is launched (<a href="https://github.com/linkedin/rest.li/blob/master/restli-netty-standalone/src/main/java/com/linkedin/restli/server/NettyStandaloneLauncher.java#L84">for example, NettyStandaloneLauncher</a>), so the user does not run these task using another engine explicitly, instead, Rest.Li framework will the run the method’s returning <code class="highlighter-rouge">Task</code> using the ParSeq engine when the method is invoked. (For details check <a href="https://github.com/linkedin/rest.li/blob/master/restli-server/src/main/java/com/linkedin/restli/internal/server/RestLiMethodInvoker.java">RestLiMethodInvoker.java</a>). Also refer to <a href="./Asynchronous-Servers-and-Clients-in-Rest_li.md">this document page</a> regarding the best practice of writing asynchronous client and service logic. <code class="highlighter-rouge">Callback</code>-based methods do not receive special treatment.</p>

<h2 id="sub-resources">Sub-Resources</h2>

<p>Sub-resources may be defined by setting the <code class="highlighter-rouge">parent</code> field on
<code class="highlighter-rouge">@RestLiCollection</code> to the class of the parent resource of
the sub-resource.</p>

<p>For example, a sub-resource of the fortunes resource would have a URI
path of the form:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/fortunes/{fortuneId}/subresource
</code></pre></div></div>

<p>Parent resource keys can be accessed by sub-resources, as shown in the
following example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestLiCollection</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"subresource"</span><span class="o">,</span> <span class="n">namespace</span> <span class="o">=</span> <span class="s">"com.example.fortune"</span><span class="o">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="nc">FortunesResource</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SubResource</span> <span class="kd">extends</span> <span class="nc">CollectionResourceTemplate</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">SubResourceEntity</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
  <span class="kd">public</span> <span class="nc">Greeting</span> <span class="nf">get</span><span class="o">(</span><span class="nc">Long</span> <span class="n">key</span><span class="o">,</span> <span class="nd">@Keys</span> <span class="nc">PathKeys</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">Long</span> <span class="n">parentId</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="na">getAsLong</span><span class="o">(</span><span class="s">"fortuneId"</span><span class="o">);</span>
      <span class="o">...</span>
  <span class="o">}</span>
<span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Alternatively, if not using free form methods, the path key can
retrieved from the resource context. This approach may be deprecated in
future versions in favor of <code class="highlighter-rouge">@Keys</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">SubResourceEntity</span> <span class="nf">get</span><span class="o">(</span><span class="nc">Long</span> <span class="n">subresourceKey</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Long</span> <span class="n">parentId</span> <span class="o">=</span> <span class="n">getContext</span><span class="o">().</span><span class="na">getPathKeys</span><span class="o">().</span><span class="na">getAsLong</span><span class="o">(</span><span class="s">"fortuneId"</span><span class="o">);</span>
  <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>For details on how to make requests to sub-resources from a client, see <a href="/rest.li/user_guide/restli_client#calling-sub-resources">Calling Sub-resources</a></p>

<h4 id="restlicollection-with-complex-key">@RestLiCollection with Complex Key</h4>

<p>Classes implementing <code class="highlighter-rouge">ComplexKeyResource</code> can use a record type as key.
This allows for arbitrary complex hierarchical structures to be used to
key a collection resource, unlike CollectionResources, which only
support primitive type keys (or typerefs to primitive types).
<code class="highlighter-rouge">ComplexKeyResourceTemplate</code> is a convenient base class to extend when
implementing a <code class="highlighter-rouge">ComplexKeyResource</code>.</p>

<p>The full interface is:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ComplexKeyResource</span><span class="o">&lt;</span><span class="no">K</span> <span class="kd">extends</span> <span class="nc">RecordTemplate</span><span class="o">,</span> <span class="no">P</span> <span class="kd">extends</span>
<span class="nc">RecordTemplate</span><span class="o">,</span> <span class="no">V</span> <span class="kd">extends</span> <span class="nc">RecordTemplate</span><span class="o">&gt;</span> <span class="o">...</span>
</code></pre></div></div>

<p>A complex key consists of a <code class="highlighter-rouge">Key</code> and <code class="highlighter-rouge">Parameter</code> part. The <code class="highlighter-rouge">Key</code> should
uniquely identify the entities of the collection while the parameters
may optionally be added to allow additional information that is not used
to lookup an entity, such as a version tag for concurrency control.</p>

<p>Since the parameters are often not needed, an <code class="highlighter-rouge">EmptyRecord</code> may be used
in the generic signature of a <code class="highlighter-rouge">ComplexKeyResource</code> to
indicate that no “Parameters” are used to key the collection.</p>

<p>Example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestLiCollection</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"widgets"</span><span class="o">,</span> <span class="n">namespace</span> <span class="o">=</span> <span class="s">"com.example.widgets"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WidgetResource</span> <span class="kd">extends</span> <span class="nc">ComplexKeyResourceTemplate</span><span class="o">&lt;</span><span class="nc">WidgetKey</span><span class="o">,</span> <span class="nc">EmptyRecord</span><span class="o">,</span> <span class="nc">Widget</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="kd">public</span> <span class="nc">Widget</span> <span class="nf">get</span><span class="o">(</span><span class="nc">ComplexResourceKey</span><span class="o">&lt;</span><span class="nc">WidgetKey</span><span class="o">,</span> <span class="nc">EmptyRecord</span><span class="o">&gt;</span> <span class="n">ck</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="nc">WidgetKey</span> <span class="n">key</span> <span class="o">=</span> <span class="n">ck</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">getNumber</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">make</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">getThing</span><span class="o">().</span><span class="na">getMake</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">model</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">getThing</span><span class="o">().</span><span class="na">getModel</span><span class="o">();</span>
    <span class="k">return</span> <span class="nf">lookupWidget</span><span class="o">(</span><span class="n">number</span><span class="o">,</span> <span class="n">make</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>To use <code class="highlighter-rouge">EmptyRecord</code>, <code class="highlighter-rouge">restli-common</code> must be in
the <code class="highlighter-rouge">dataModel</code> dependencies for the api project where client
bindings are generated, as shown in the following example:</p>

<p><code class="highlighter-rouge">api/build.gradle</code>:</p>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">dependencies</span> <span class="o">{</span>
  <span class="c1">// ...</span>
  <span class="n">dataModel</span> <span class="n">spec</span><span class="o">.</span><span class="na">product</span><span class="o">.</span><span class="na">pegasus</span><span class="o">.</span><span class="na">restliCommon</span>
<span class="o">}</span>
</code></pre></div></div>

<p>where <code class="highlighter-rouge">WidgetKey</code> is defined by the schema:</p>

<div class="language-pdl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">namespace</span> <span class="n">com.example.widget</span><span class="p">

</span><span class="kr">record</span><span class="p"> </span><span class="n">WidgetKey</span><span class="p"> {
  </span><span class="nl">number</span><span class="p">:</span> <span class="kt">string</span><span class="p">

  </span><span class="nl">thing</span><span class="p">:</span> <span class="kr">record</span><span class="p"> </span><span class="n">Thing</span><span class="p"> {
    </span><span class="nl">make</span><span class="p">:</span> <span class="kt">string</span><span class="p">
    </span><span class="nl">model</span><span class="p">:</span> <span class="kt">string</span><span class="p">
  }
}
</span></code></pre></div></div>

<p>Example request:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s2">"http://&lt;hostname:port&gt;/widgets/number=1&amp;thing.make=adruino&amp;thing.model=uno"</span>
</code></pre></div></div>

<p>If params are added, they are represented in the URL under the
“$params” prefix like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s2">"http://&lt;hostname:port&gt;/widgets/number=1&amp;thing.make=adruino&amp;thing.model=uno&amp;</span><span class="nv">$params</span><span class="s2">.version=1"</span>
</code></pre></div></div>

<p>The implementation of complex key collection is identical to the regular
<code class="highlighter-rouge">RestLiCollection</code> with the exception that it extends
<code class="highlighter-rouge">ComplexKeyResourceTemplate</code> (or directly implements
<code class="highlighter-rouge">ComplexKeyResource</code>) and takes three ﻿type parameters instead of two:
key type, key parameter type, and value type — each extending
@RecordTemplate.</p>

<p>For details on how a complex key is represented in a request URL, see
<a href="/rest.li/spec/protocol#complex-types">Rest.li Protocol: Complex Types</a></p>

<h4 id="restlisimpleresource">@RestLiSimpleResource</h4>

<p>The <code class="highlighter-rouge">@RestLiSimpleResource</code> annotation is applied to classes to mark
them as providing a Rest.li simple resource. Simple resources model an
entity which is a singleton in a particular scope. See the description
of the <a href="/rest.li/modeling/modeling#simple">Simple Resource Pattern</a> for more details.</p>

<p>The supported annotation parameters are:</p>

<ul>
  <li><code class="highlighter-rouge">name</code> - required, defines the name of the resource.</li>
  <li><code class="highlighter-rouge">namespace</code> - optional, defines the namespace for the resource.
Default is empty (root namespace). The namespace of the resource
appears in the IDL, and is used as the package name for the
generated client builders.</li>
  <li><code class="highlighter-rouge">parent</code> - optional, defines the parent resource for this resource.
Default is root.</li>
</ul>

<p>Classes annotated with <code class="highlighter-rouge">@RestLiSimpleResource</code> must implement the
<code class="highlighter-rouge">SimpleResource</code> interface. The <code class="highlighter-rouge">SimpleResource</code> interface requires a
generic type parameter <code class="highlighter-rouge">V</code>, which is the value type for the resource
(also known as, the entity type). The value type for a simple resource
must be a pegasus record, any subclass of <code class="highlighter-rouge">RecordTemplate</code> generated
from a <code class="highlighter-rouge">.pdl</code> schema.</p>

<p>For convenience, simple resources may extend <code class="highlighter-rouge">SimpleResourceTemplate</code>
rather than directly implementing the <code class="highlighter-rouge">SimpleResource</code> interface.</p>

<p>Examples:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestLiSimpleResource</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"todaysPromotedProduct"</span><span class="o">,</span> <span class="n">namespace</span> <span class="o">=</span> <span class="s">"com.example.product"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodaysPromotedProductResource</span> <span class="kd">extends</span> <span class="nc">SimpleResourceTemplate</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span>
<span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="restliassociation">@RestLiAssociation</h4>

<p>The <code class="highlighter-rouge">@RestLiAssociation</code> annotation is applied to classes to mark them
as providing a Rest.li association resource. Association resources model
a collection of relationships between entities. Each relationship is
referenced by the keys of the entities it relates and may define
attributes on the relation itself. See
<a href="/rest.li/modeling/modeling#association">Association Resource Pattern</a></p>

<p>For Example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestLiAssociation</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"memberships"</span><span class="o">,</span> <span class="n">namespace</span> <span class="o">=</span> <span class="s">"com.example"</span><span class="o">,</span>
  <span class="n">assocKeys</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nd">@Key</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"memberId"</span><span class="o">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nc">Long</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> 
    <span class="nd">@Key</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"groupId"</span><span class="o">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nc">Long</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MembershipsAssociation</span> <span class="kd">extends</span> <span class="nc">AssociationResourceTemplate</span><span class="o">&lt;</span><span class="nc">Membership</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">Membership</span> <span class="nf">get</span><span class="o">(</span><span class="nc">CompoundKey</span> <span class="n">key</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="nf">lookup</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">getPartAsLong</span><span class="o">(</span><span class="s">"memberId"</span><span class="o">,</span> <span class="n">key</span><span class="o">.</span><span class="na">getPartAsLong</span><span class="o">(</span><span class="s">"groupId"</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl http://&lt;<span class="nb">hostname</span>:port&gt;/memberships/memberId<span class="o">=</span>1&amp;groupId<span class="o">=</span>10
</code></pre></div></div>

<p>The supported annotation parameters are:</p>

<ul>
  <li><code class="highlighter-rouge">name</code> - required, defines the name of the resource.</li>
  <li><code class="highlighter-rouge">namespace</code> - optional, defines the namespace for the resource.
Default is empty (root namespace). The namespace of the resource
appears in the IDL, and is used as the package name for the
generated client builders.</li>
  <li><code class="highlighter-rouge">parent</code> - optional, defines the parent resource for this resource.
Default is root.</li>
  <li><code class="highlighter-rouge">assocKeys</code> - required, defines the list of keys for the association
resource. Each key must declare its name and type.</li>
</ul>

<p>Classes annotated with <code class="highlighter-rouge">@RestLiAssociation</code> must implement the
<code class="highlighter-rouge">AssociationResource</code> interface. The <code class="highlighter-rouge">AssociationResource</code> interface
requires a single generic type parameter:</p>

<ul>
  <li><code class="highlighter-rouge">V</code>, which is the value type for the resource, a.k.a., the entity
type.</li>
</ul>

<p>The value type for an association resource must be a subclass of
<code class="highlighter-rouge">RecordTemplate</code> generated from a <code class="highlighter-rouge">.pdl</code> schema.</p>

<p>Note that for association resources, they key type is always
<code class="highlighter-rouge">CompoundKey</code>, with key parts as defined in the <code class="highlighter-rouge">assocKeys</code> parameter of
the class’ annotation.</p>

<p>For convenience, Association resources may extend
<code class="highlighter-rouge">AssociationResourceTemplate</code> rather than directly implementing the
<code class="highlighter-rouge">AssociationResource</code> interface.</p>

<h4 id="restliactions">@RestLiActions</h4>

<p>The <code class="highlighter-rouge">@RestLiActions</code> annotation is applied to classes to mark them as
providing a Rest.li action set resource. Action set resources do not
model any resource pattern. They simply group together a set of custom
actions.</p>

<p>For example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestLiActions</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"simpleActions"</span><span class="o">,</span> <span class="n">namespace</span> <span class="o">=</span> <span class="s">"com.example"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleActionsResource</span> <span class="o">{</span>

  <span class="nd">@Action</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"echo"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">echo</span><span class="o">(</span><span class="nd">@ActionParam</span><span class="o">(</span><span class="s">"input"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">input</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="n">input</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The supported annotation parameters are:</p>

<ul>
  <li><code class="highlighter-rouge">name</code> - required, defines the name of the resource.</li>
  <li><code class="highlighter-rouge">namespace</code> - optional, defines the namespace for the resource.
Default is empty (root namespace).</li>
</ul>

<p>Action set resources do not have a key or value type, and do not need to
<code class="highlighter-rouge">implement</code> any framework interfaces.</p>

<p><a id="wiki-ResourceMethods"></a></p>

<h2 id="resource-methods">Resource Methods</h2>

<p>Resource methods are operations a resource can perform. Rest.li defines
a standard set of resource methods, each with its own interface pattern
and intended semantics.</p>

<p>The set of possible resource methods is constrained by the resource
type, as described in the table below:</p>

<table>
  <thead>
    <tr>
      <th>Resource Type</th>
      <th>Collection</th>
      <th>Simple</th>
      <th>Association</th>
      <th>Action Set</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GET</td>
      <td>x</td>
      <td>x</td>
      <td>x</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>BATCH_GET / GET_ALL</td>
      <td>x</td>
      <td> </td>
      <td>x</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>FINDER</td>
      <td>x</td>
      <td> </td>
      <td>x</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>BATCH_FINDER</td>
      <td>x</td>
      <td> </td>
      <td>x</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>CREATE / BATCH_CREATE</td>
      <td>x</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>UPDATE / PARTIAL_UPDATE</td>
      <td>x</td>
      <td>x</td>
      <td>x</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>BATCH_UPDATE \ BATCH_PARTIAL_UPDATE</td>
      <td>x</td>
      <td> </td>
      <td>x</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>DELETE</td>
      <td>x</td>
      <td>x</td>
      <td>x</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>BATCH_DELETE</td>
      <td>x</td>
      <td> </td>
      <td>x</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>ACTION</td>
      <td>x</td>
      <td>x</td>
      <td>x</td>
      <td>x</td>
    </tr>
  </tbody>
</table>

<p>In the section below, <code class="highlighter-rouge">K</code> is used to denote the resource’s key type, and
<code class="highlighter-rouge">V</code> is used to denote the resource’s value type. Remember that for
association resources, <code class="highlighter-rouge">K</code> is always <code class="highlighter-rouge">CompoundKey</code>.</p>

<p><a id="GET"></a></p>

<h4 id="get">GET</h4>

<p>The GET resource method is intended to retrieve a single entity
representation based upon its key or without a key from a simple
resource. GET should not have any visible side effects. For example, it
should be safe to call whenever the client wishes.</p>

<p>Resources providing the GET resource method must override one of the
following method signatures.</p>

<p>For collection and association resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="no">V</span> <span class="nf">get</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
</code></pre></div></div>

<p>For simple resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="no">V</span> <span class="nf">get</span><span class="o">();</span>
</code></pre></div></div>

<p>For asynchronous resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="nf">get</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
</code></pre></div></div>

<p>Get methods can also be annotated if not overriding a base class method.
GET supports a method signature with a wrapper return type.</p>

<p>For collection and association resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
<span class="kd">public</span> <span class="nc">GetResult</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="nf">getWithStatus</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
</code></pre></div></div>

<p>For simple resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
<span class="kd">public</span> <span class="nc">GetResult</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="nf">getWithStatus</span><span class="o">();</span>
</code></pre></div></div>

<p>For asynchronous resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
<span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">GetResult</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;&gt;</span> <span class="nf">getWithStatus</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
</code></pre></div></div>

<p>An annotated get method may also have arbitrary query params added:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
<span class="kd">public</span> <span class="nc">GetResult</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="nf">get</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"viewerId"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">viewerId</span><span class="o">);</span>
</code></pre></div></div>

<p>The return type <code class="highlighter-rouge">GetResult&lt;V&gt;</code> allows users to set an arbitrary HTTP
status code for the response. For more information about the
<code class="highlighter-rouge">RestMethod.Get</code> annotation, see <a href="#free-form-resources">Free-Form
Resources</a>.</p>

<p><a id="BATCH_GET"></a></p>

<h4 id="batch_get">BATCH_GET</h4>

<p>The BATCH_GET resource method retrieves multiple entity representations
given their keys. BATCH_GET should not have any visible side effects.
For example, it should be safe to call whenever the client wishes.
However, this is not something enforced by the framework, and it is up
to the application developer that there are no side effects.</p>

<p>Resources providing the BATCH_GET resource method must override the
following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchGet</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
</code></pre></div></div>

<p>An asynchronous method must override the following method signature:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;&gt;</span> <span class="nf">batchGet</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
</code></pre></div></div>

<p>@<code class="highlighter-rouge">RestMethod.BatchGet</code> may be used to indicate a batch get method
instead of overriding the batchGet method of a base class.</p>

<p>Resources may also return <code class="highlighter-rouge">BatchResult</code>, which allows errors to be
returned along with entities that were successfully retrieved.</p>

<p>Example of a batch get:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">batchGet</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">batch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;();</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">RestLiServiceException</span><span class="o">&gt;</span> <span class="n">errors</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">RestLiServiceException</span><span class="o">&gt;();</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">long</span> <span class="n">id</span> <span class="o">:</span> <span class="n">ids</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="nc">Greeting</span> <span class="n">g</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">g</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
    <span class="o">{</span>
      <span class="n">batch</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">g</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">else</span>
    <span class="o">{</span>
      <span class="n">errors</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="k">new</span> <span class="nc">RestLiServiceException</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_404_NOT_FOUND</span><span class="o">));</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nc">BatchResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;(</span><span class="n">batch</span><span class="o">,</span> <span class="n">errors</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Clients should make requests to a batch resource using <code class="highlighter-rouge">buildKV()</code> (not
<code class="highlighter-rouge">build()</code>, it is deprecated), for example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">FortunesBuilders</span><span class="o">().</span><span class="na">batchGet</span><span class="o">().</span><span class="na">ids</span><span class="o">(...).</span><span class="na">buildKV</span><span class="o">();</span>
</code></pre></div></div>

<p><a id="GET_ALL"></a></p>

<h4 id="get_all">GET_ALL</h4>

<p>When a GET is requested on a collection or association resource with no
key provided (for example, /myResource), the GET_ALL resource method is
invoked, if present. The GET_ALL resource method retrieves all entities
for the collection and supports the same pagination facilities as a
FINDER.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="nf">getAll</span><span class="o">(</span><span class="nd">@Context</span> <span class="nc">PagingContext</span> <span class="n">pagingContext</span><span class="o">);</span>
</code></pre></div></div>

<p>An asynchronous resource would implement the following method signature:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;&gt;</span> <span class="nf">getAll</span><span class="o">(</span><span class="nd">@Context</span> <span class="nc">PagingContext</span> <span class="n">pagingContext</span><span class="o">);</span>
</code></pre></div></div>

<p>@<code class="highlighter-rouge">RestMethod.GetAll</code> may be used to indicate a get all method instead of
overriding the getAll method of a base class.</p>

<p>To directly control the total and metadata returned by a get all method,
do not override getAll. Instead, create a new method with the
@<code class="highlighter-rouge">RestMethod.GetAll</code> annotation and return a <code class="highlighter-rouge">CollectionResult</code> rather
than a list, for example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestMethod</span><span class="o">.</span><span class="na">GetAll</span>
<span class="kd">public</span> <span class="nc">CollectionResult</span><span class="o">&lt;</span><span class="nc">Widgets</span><span class="o">,</span> <span class="nc">WidgetsMetadata</span><span class="o">&gt;</span> <span class="nf">getAllWidgets</span><span class="o">(</span><span class="nd">@Context</span> <span class="nc">PagingContext</span> <span class="n">pagingContext</span><span class="o">)</span>
<span class="o">{</span>
  <span class="c1">// ...</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nc">CollectionResult</span><span class="o">&lt;</span><span class="nc">Widgets</span><span class="o">,</span> <span class="nc">WidgetsMetadata</span><span class="o">&gt;(</span><span class="n">pageOfWidgets</span><span class="o">,</span> <span class="n">total</span><span class="o">,</span> <span class="n">metadata</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>When returning a CollectionResult from GetAll, the behavior is identical
to a FINDER. See the FINDER documentation below for additional details
about CollectionResult.</p>

<p><a id="FINDER"></a></p>

<h4 id="finder">FINDER</h4>

<p>FINDER methods model query operations. For example, they retrieve an
ordered list of 0 or more entities based on criteria specified in the
query parameters. Finder results will automatically be paginated by the
Rest.li framework. Like GET methods, FINDER methods should not have side
effects.</p>

<p>Resources may provide zero or more FINDER resource methods. Each finder
method must be annotated with the <code class="highlighter-rouge">@Finder</code> annotation.</p>

<p>Pagination default to start=0 and count=10. Clients may set both of
these parameters to any desired value.</p>

<p>The <code class="highlighter-rouge">@Finder</code> annotation takes a single required parameter, which
indicates the name of the finder method.</p>

<p>For example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
You can access this FINDER method via
/resources/order?q=findOrder&amp;buyerType=1&amp;buyerId=309&amp;orderId=1208210101
*/</span>
<span class="nd">@RestLiCollection</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"order"</span><span class="o">,</span><span class="n">keyName</span><span class="o">=</span><span class="s">"orderId"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderResource</span> <span class="kd">extends</span> <span class="nc">CollectionResourceTemplate</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span><span class="nc">Order</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="nd">@Finder</span><span class="o">(</span><span class="s">"findOrder"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="nf">findOrder</span><span class="o">(</span><span class="nd">@Context</span> <span class="nc">PagingContext</span> <span class="n">context</span><span class="o">,</span>
                               <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"buyerId"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">buyerId</span><span class="o">,</span>
                               <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"buyerType"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">buyerType</span><span class="o">,</span>
                               <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"orderId"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">orderId</span><span class="o">)</span>
                              <span class="kd">throws</span> <span class="nc">InternalException</span>
  <span class="o">{</span>
  <span class="o">...</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Finder methods must return either:</p>

<ul>
  <li><code class="highlighter-rouge">List&lt;V&gt;</code></li>
  <li><code class="highlighter-rouge">CollectionResult&lt;V, MetaData&gt;</code></li>
  <li><code class="highlighter-rouge">BasicCollectionResult&lt;V&gt;</code>, a subclass of <code class="highlighter-rouge">CollectionResult</code></li>
  <li>a subclass of one the above</li>
</ul>

<p>Every parameter of a finder method must be annotated with one of:</p>

<ul>
  <li><code class="highlighter-rouge">@Context</code> - indicates that the parameter provides framework context
to the method. Currently all <code class="highlighter-rouge">@Context</code> parameters must be of type
<code class="highlighter-rouge">PagingContext</code>.</li>
  <li><code class="highlighter-rouge">@QueryParam</code> - indicates that the value of the parameter is
obtained from a request query parameter. The value of the annotation
indicates the name of the query parameter. Duplicate names are not
allowed for the same finder method.</li>
  <li><code class="highlighter-rouge">@AssocKey</code> - indicates that the value of the parameter is a partial
association key, obtained from the request. The value of the
annotation indicates the name of the association key, which must
match the name of an <code class="highlighter-rouge">@Key</code> provided in the <code class="highlighter-rouge">assocKeys</code> field of the
<code class="highlighter-rouge">@RestLiAssociation</code> annotation.</li>
</ul>

<p>Parameters marked with <code class="highlighter-rouge">@QueryParam</code>, <code class="highlighter-rouge">@ActionParam</code>, and <code class="highlighter-rouge">@AssocKey</code>
may also be annotated with <code class="highlighter-rouge">@Optional</code>, which indicates that the
parameter is not required. The <code class="highlighter-rouge">@Optional</code> annotation may specify a
String value, indicating the default value to be used if the parameter
is not provided in the request. If the method parameter is of primitive
type, a default value must be specified in the <code class="highlighter-rouge">@Optional</code> annotation.</p>

<p>Valid types for query parameters are:</p>

<ul>
  <li><code class="highlighter-rouge">String</code></li>
  <li><code class="highlighter-rouge">boolean</code> / <code class="highlighter-rouge">Boolean</code></li>
  <li><code class="highlighter-rouge">int</code> / <code class="highlighter-rouge">Integer</code></li>
  <li><code class="highlighter-rouge">long</code> / <code class="highlighter-rouge">Long</code></li>
  <li><code class="highlighter-rouge">float</code> / <code class="highlighter-rouge">Float</code></li>
  <li><code class="highlighter-rouge">double</code> / <code class="highlighter-rouge">Double</code></li>
  <li><code class="highlighter-rouge">ByteString</code></li>
  <li>A Pegasus Enum (any enum defined in a <code class="highlighter-rouge">.pdl</code> schema)</li>
  <li>Custom types (see the bottom of this section)</li>
  <li>Record template types (any subclass of <code class="highlighter-rouge">RecordTemplate</code> generated
from a <code class="highlighter-rouge">.pdl</code> schema)</li>
  <li>Arrays of one of the types above, e.g. <code class="highlighter-rouge">String[]</code>, <code class="highlighter-rouge">long[]</code>, …</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Finder</span><span class="o">(</span><span class="s">"simpleFinder"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="nf">simpleFind</span><span class="o">(</span><span class="err">`</span><span class="nc">Context</span> <span class="nc">PagingContext</span> <span class="n">context</span><span class="o">);</span>

<span class="nd">@Finder</span><span class="o">(</span><span class="s">"complexFinder"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">CollectionResult</span><span class="o">&lt;</span><span class="no">V</span><span class="o">,</span> <span class="nc">MyMetaData</span><span class="o">&gt;</span> <span class="nf">complexFinder</span><span class="o">(</span><span class="nd">@Context</span><span class="o">(</span><span class="n">defaultStart</span><span class="o">=</span> <span class="mi">10</span><span class="o">,</span> <span class="n">defaultCount</span> <span class="o">=</span> <span class="mi">100</span><span class="o">)</span> <span class="nc">PagingContext</span> <span class="n">context</span><span class="o">,</span>
                                                     <span class="nd">@AssocKey</span><span class="o">(</span><span class="s">"key1"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">key</span><span class="o">,</span>
                                                     <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"param1"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">requiredParam</span><span class="o">,</span>
                                                     <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"param2"</span><span class="o">)</span> <span class="nd">@Optional</span> <span class="nc">String</span> <span class="n">optionalParam</span><span class="o">);</span>
</code></pre></div></div>

<p>A Finder method in an asynchronous resource could implement the following method signatures:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Finder</span><span class="o">(</span><span class="s">"simpleAsyncFinder"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;&gt;</span> <span class="nf">simpleFind</span><span class="o">(</span><span class="err">`</span><span class="nc">Context</span> <span class="nc">PagingContext</span> <span class="n">context</span><span class="o">);</span>

<span class="nd">@Finder</span><span class="o">(</span><span class="s">"complexAsyncFinder"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">CollectionResult</span><span class="o">&lt;</span><span class="no">V</span><span class="o">,</span> <span class="nc">MyMetaData</span><span class="o">&gt;&gt;</span> <span class="nf">complexFinder</span><span class="o">(</span><span class="nd">@Context</span><span class="o">(</span><span class="n">defaultStart</span><span class="o">=</span> <span class="mi">10</span><span class="o">,</span> <span class="n">defaultCount</span> <span class="o">=</span> <span class="mi">100</span><span class="o">)</span> <span class="nc">PagingContext</span> <span class="n">context</span><span class="o">,</span>
                                                     <span class="nd">@AssocKey</span><span class="o">(</span><span class="s">"key1"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">key</span><span class="o">,</span>
                                                     <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"param1"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">requiredParam</span><span class="o">,</span>
                                                     <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"param2"</span><span class="o">)</span> <span class="nd">@Optional</span> <span class="nc">String</span> <span class="n">optionalParam</span><span class="o">);</span>
</code></pre></div></div>

<p><a id="TyperefSchema"></a></p>

<h4 id="typerefs-custom-types">Typerefs (Custom Types)</h4>

<p>Custom types can be any Java type, as long as it has a coercer and a
typeref schema, even Java classes from libraries such as Date. To create
a query parameter that uses a custom type, you will need to write a
coercer and a typeref schema for the type you want to use. See the
<a href="/rest.li/pdl_schema#typerefs">typeref documentation</a> for details.</p>

<p>First for the coercer, you will need to write an implementation of
DirectCoercer that converts between your custom type and some simpler
underlying type, like String or Double. By convention, the coercer
should be an internal class of the custom type it coerces. Additionally,
the custom type should register its own coercer in a static code block.</p>

<p>If this is not possible (for example, if you want to use a Java built-in
class like Date or URI as a custom type), then you can write a separate
coercer class and register the coercer with the private variable
declaration:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Object</span> <span class="no">REGISTER_COERCER</span> <span class="o">=</span> <span class="nc">Custom</span><span class="o">.</span><span class="na">registerCoercer</span><span class="o">(</span><span class="k">new</span> <span class="nc">ObjectCoercer</span><span class="o">(),</span> <span class="nc">CustomObject</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</code></pre></div></div>

<p>Typeref Schema</p>

<p>The purpose of the typeref schemas is to keep track of the underlying
type of the custom Type and the location of the custom type’s class,
and, if necessary, the location of its coercer. The basic appearance of
the typeref schema is shown below:</p>

<div class="language-pdl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">namespace</span> <span class="n">com.linkedin.example</span><span class="p"> </span><span class="c1">// namespace of the typeref</span><span class="p">

</span><span class="nd">@java.class</span> <span class="p">=</span><span class="w"> </span><span class="s2">"com.linkedin.example.CustomObject"</span><span class="p"> </span><span class="c1">// location of the custom type class</span><span class="p">
</span><span class="nd">@java.coercerClass</span> <span class="p">=</span><span class="w"> </span><span class="s2">"com.linkedin.example.CustomObjectCoercer"</span><span class="p"> </span><span class="c1">// only needed if the custom type itself cannot contain the coercer as an internal class.</span><span class="p">
</span><span class="kr">typeref</span><span class="p"> </span><span class="n">CustomObjectRef</span><span class="p"> = </span><span class="kt">string</span><span class="p"> </span><span class="c1">// underlying type that the coercer converts to/from</span><span class="p">
</span></code></pre></div></div>

<p>This typeref can then be referenced in other schemas:</p>

<div class="language-pdl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">import</span> <span class="n">com.linkedin.example.CustomObjectRef</span><span class="p">

</span><span class="kr">record</span><span class="p"> </span><span class="n">ExampleRecord</span><span class="p"> {
  </span><span class="nl">member</span><span class="p">:</span> <span class="n">CustomObjectRef</span><span class="p">
}
</span></code></pre></div></div>

<p>The generated Java data templates will automatically coerce from
CustomObjectRef to CustomObject when accessing the member field:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">CustomObject</span> <span class="n">o</span> <span class="o">=</span> <span class="n">exampleRecord</span><span class="o">.</span><span class="na">getMember</span><span class="o">();</span>
</code></pre></div></div>

<p>Once Java data templates are generated, the typeref may also be used in
Keys, query parameters, or action parameters.</p>

<p>Keys:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestLiCollection</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"entities"</span><span class="o">,</span> 
                  <span class="n">namespace</span> <span class="o">=</span> <span class="s">"com.example"</span><span class="o">,</span>
                  <span class="n">keyTyperefClass</span> <span class="o">=</span> <span class="nc">CustomObjectRef</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EntitiesResource</span> <span class="kd">extends</span> <span class="nc">CollectionResourceTemplate</span><span class="o">&lt;</span><span class="nc">CustomObject</span><span class="o">,</span> <span class="nc">Urn</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>Compound keys:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestLiAssociation</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"entities"</span><span class="o">,</span> 
                   <span class="n">namespace</span><span class="o">=</span><span class="s">"com.example"</span><span class="o">,</span>
                   <span class="n">assocKeys</span><span class="o">={</span><span class="nd">@Key</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"o"</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="nc">CustomObject</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">typeref</span><span class="o">=</span><span class="nc">CustomObjectRef</span><span class="o">.</span><span class="na">class</span><span class="o">)})</span>
</code></pre></div></div>

<p>Query parameters:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@QueryParam</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"o"</span><span class="o">,</span> <span class="n">typeref</span><span class="o">=</span><span class="nc">CustomObjectRef</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="nc">CustomObject</span> <span class="n">o</span>

<span class="nd">@QueryParam</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"oArray"</span><span class="o">,</span> <span class="n">typeref</span><span class="o">=</span><span class="nc">CustomObjectRef</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="nc">CustomObject</span><span class="o">[]</span> <span class="n">oArray</span>
</code></pre></div></div>

<p><a id="BATCHFINDER"></a></p>

<h4 id="batch-finder">BATCH FINDER</h4>

<p>The BATCH_FINDER resource method accepts a list of filters set. Instead of callings multiple finders with different filter values, we call 1 BATCH_FINDER method with a list of filters.</p>

<p>Resources may provide zero or more BATCH_FINDER resource methods. Each BATCH_FINDER method must be annotated with the <code class="highlighter-rouge">@BatchFinder</code> annotation.
And this method must return a <code class="highlighter-rouge">BatchFinderResult</code>.
For example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@BatchFinder</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"searchGreetings"</span><span class="o">,</span> <span class="n">batchParam</span> <span class="o">=</span> <span class="s">"criteria"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">BatchFinderResult</span><span class="o">&lt;</span><span class="nc">GreetingCriteria</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">,</span> <span class="nc">EmptyRecord</span><span class="o">&gt;</span> <span class="nf">searchGreetings</span><span class="o">(</span><span class="nd">@PagingContextParam</span> <span class="nc">PagingContext</span> <span class="n">context</span><span class="o">,</span>
                                                                                  <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"criteria"</span><span class="o">)</span> <span class="nc">GreetingCriteria</span><span class="o">[]</span> <span class="n">criteria</span><span class="o">,</span>
                                                                                  <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"message"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span>
</code></pre></div></div>

<p>An asynchronous BATCH_FINDER must return a <code class="highlighter-rouge">Task&lt;BatchFinderResult&gt;</code>. For example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@BatchFinder</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"searchGreetings"</span><span class="o">,</span> <span class="n">batchParam</span> <span class="o">=</span> <span class="s">"criteria"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">BatchFinderResult</span><span class="o">&lt;</span><span class="nc">GreetingCriteria</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">,</span> <span class="nc">EmptyRecord</span><span class="o">&gt;&gt;</span> <span class="nf">searchGreetings</span><span class="o">(</span><span class="nd">@PagingContextParam</span> <span class="nc">PagingContext</span> <span class="n">context</span><span class="o">,</span>
                                                                                  <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"criteria"</span><span class="o">)</span> <span class="nc">GreetingCriteria</span><span class="o">[]</span> <span class="n">criteria</span><span class="o">,</span>
                                                                                  <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"message"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span>
</code></pre></div></div>

<p>Please note that “q” cannot be used as QueryParam name for batch finder, because that will produce ambiguation when construcitng URL.</p>

<p>See more details about BATCH_FINDER resource method api here: <a href="/rest.li/batch_finder_resource_method#resource-api">BatchFinder Resource API</a></p>

<p><a id="CREATE"></a></p>

<h4 id="create">CREATE</h4>

<p>CREATE methods model the creation of new entities from their
representation. In CREATE, the resource implementation is responsible
for assigning a new key to the created entity. CREATE methods are
neither safe nor idempotent.</p>

<p>Resources providing the CREATE resource method must override the
following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">CreateResponse</span> <span class="nf">create</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
</code></pre></div></div>

<p>An asynchronous method would override the following method signature:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">CreateResponse</span><span class="o">&gt;</span> <span class="nf">create</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
</code></pre></div></div>

<p>The returned <code class="highlighter-rouge">CreateResponse</code> object indicates the HTTP status code to
be returned (defaults to 201 CREATED), as well as an optional ID for the
newly created entity. If provided, the ID will be written into the
“X-LinkedIn-Id” header by calling <code class="highlighter-rouge">toString()</code> on the ID object.</p>

<p>@<code class="highlighter-rouge">RestMethod.Create</code> may be used to indicate a create method instead of
overriding the create method of a base class.</p>

<h4 id="returning-entity-in-create-response">Returning entity in CREATE response</h4>

<p>By default, the newly created entity is not returned in the CREATE
response because the client already has the entity when sending the
CREATE request. However, there are use cases where the server will
attach additional data to the new entity. Returning the entity in the
CREATE response saves the client another GET request.</p>

<p>Starting in Rest.li version 2.10.3, we provide the developer the option to
return the newly created entity. To use this feature, add a <code class="highlighter-rouge">@ReturnEntity</code>
annotation to the method that implements CREATE. The return type of the
method must be <code class="highlighter-rouge">CreateKVResponse</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ReturnEntity</span>
<span class="kd">public</span> <span class="nc">CreateKVResponse</span> <span class="nf">create</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
</code></pre></div></div>

<p>An example implementation for resource is like below, note that the return type will be  <code class="highlighter-rouge">CreateKVResponse</code> :</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ReturnEntity</span>
<span class="kd">public</span> <span class="nc">CreateKVResponse</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">create</span><span class="o">(</span><span class="nc">Greeting</span> <span class="n">entity</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Long</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
  <span class="n">entity</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nc">CreateKVResponse</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;(</span><span class="n">entity</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">entity</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>There may be circumstances in which you want to prevent the server from returning the entity, for example to reduce network traffic.
Here is an example curl request that makes use of the <a href="/rest.li/spec/return_entity#client-specified-behavior"><code class="highlighter-rouge">$returnEntity</code> query parameter</a> to indicate that the entity should not be returned:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST <span class="s1">'localhost:/greetings?$returnEntity=false'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'X-RestLi-Method: CREATE'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"message": "Hello, world!", "tone": "FRIENDLY"}'</span>
</code></pre></div></div>

<p><a id="BATCH_CREATE"></a></p>

<h4 id="batch_create">BATCH_CREATE</h4>

<p>BATCH_CREATE methods model the creation of a group of new entities from
their representations. In BATCH_CREATE, the resource implementation is
responsible for assigning a new key to each created entity.
BATCH_CREATE methods are neither safe nor idempotent.</p>

<p>Resources providing the BATCH_CREATE resource method must override the
following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
</code></pre></div></div>

<p>An asynchronous resource providing the BATCH_CREATE resource method must override the
following method signature:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;&gt;</span> <span class="nf">batchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">BatchCreateRequest</code> object wraps a list of entity representations
of type <code class="highlighter-rouge">V</code>.</p>

<p>The returned <code class="highlighter-rouge">BatchCreateResult</code> object wraps a list of <code class="highlighter-rouge">CreateResponse</code>
objects (see CREATE). The <code class="highlighter-rouge">CreateResponse</code> objects are expected to be
returned in the same order and position as the respective input objects.</p>

<p><code class="highlighter-rouge">BatchCreateRequest</code> and <code class="highlighter-rouge">BatchCreateResult</code> support the generic type
parameter <code class="highlighter-rouge">K</code> to allow for future extension.</p>

<p>@<code class="highlighter-rouge">RestMethod.BatchCreate</code> may be used to indicate a batch create method
instead of overriding the batchCreate method of a base class.</p>

<p>Example of a batch create:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">batchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CreateResponse</span><span class="o">&gt;</span> <span class="n">responses</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">CreateResponse</span><span class="o">&gt;(</span><span class="n">entities</span><span class="o">.</span><span class="na">getInput</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>

  <span class="k">for</span> <span class="o">(</span><span class="nc">Greeting</span> <span class="n">g</span> <span class="o">:</span> <span class="n">entities</span><span class="o">.</span><span class="na">getInput</span><span class="o">())</span>
  <span class="o">{</span>
    <span class="n">responses</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">create</span><span class="o">(</span><span class="n">g</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;(</span><span class="n">responses</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="nc">CreateResponse</span> <span class="nf">create</span><span class="o">(</span><span class="nc">Greeting</span> <span class="n">entity</span><span class="o">)</span>
<span class="o">{</span>
  <span class="n">entity</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">_idSeq</span><span class="o">.</span><span class="na">incrementAndGet</span><span class="o">());</span>
  <span class="n">_db</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entity</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">entity</span><span class="o">);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nf">CreateResponse</span><span class="o">(</span><span class="n">entity</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Error details can be returned in any CreateResponse by providing a
RestLiServiceException, for example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">batchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">)</span> 
<span class="o">{</span>
  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CreateResponse</span><span class="o">&gt;</span> <span class="n">responses</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">CreateResponse</span><span class="o">&gt;(</span><span class="n">entities</span><span class="o">.</span><span class="na">getInput</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>

  <span class="o">...</span>
  <span class="k">if</span> <span class="o">(...)</span>
  <span class="o">{</span>
    <span class="nc">RestLiServiceException</span> <span class="n">exception</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RestLiServiceException</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_406_NOT_ACCEPTABLE</span><span class="o">,</span> <span class="s">"..."</span><span class="o">);</span>
    <span class="n">exception</span><span class="o">.</span><span class="na">setServiceErrorCode</span><span class="o">(...);</span>
    <span class="n">exception</span><span class="o">.</span><span class="na">setErrorDetails</span><span class="o">(...);</span>
    <span class="n">responses</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">CreateResponse</span><span class="o">(</span><span class="n">exception</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="o">...</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;(</span><span class="n">responses</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="returning-entities-in-batch_create-response">Returning entities in BATCH_CREATE response</h4>

<p>Similar to CREATE, BATCH_CREATE also could return the newly created
entities in the response. To do that, add a <code class="highlighter-rouge">@ReturnEntity</code> annotation to
the method implementing BATCH_CREATE. The return type of the method
must be <code class="highlighter-rouge">BatchCreateKVResult</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ReturnEntity</span>
<span class="kd">public</span> <span class="nc">BatchCreateKVResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
</code></pre></div></div>

<p>An example implementation for resource is like below, note that the
return type will be <code class="highlighter-rouge">BatchCreateKVResult</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ReturnEntity</span>
<span class="kd">public</span> <span class="nc">BatchCreateKVResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">batchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CreateKVResponse</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;&gt;</span> <span class="n">responses</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">CreateKVResponse</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;&gt;(</span><span class="n">entities</span><span class="o">.</span><span class="na">getInput</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>
  <span class="k">for</span> <span class="o">(</span><span class="nc">Greeting</span> <span class="n">greeting</span> <span class="o">:</span> <span class="n">entities</span><span class="o">.</span><span class="na">getInput</span><span class="o">())</span>
  <span class="o">{</span>
    <span class="n">responses</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">create</span><span class="o">(</span><span class="n">greeting</span><span class="o">));</span> <span class="c1">// Create function should return CreateKVResponse</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="nc">BatchCreateKVResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;(</span><span class="n">responses</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>There may be circumstances in which you want to prevent the server from returning the entity, for example to reduce network traffic.
Here is an example curl request that makes use of the <a href="/rest.li/spec/return_entity#client-specified-behavior"><code class="highlighter-rouge">$returnEntity</code> query parameter</a> to indicate that the entity should not be returned:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST <span class="s1">'localhost:/greetings?$returnEntity=false'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'X-RestLi-Method: BATCH_CREATE'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"elements":[{"message": "Hello, world!", "tone": "FRIENDLY"},{"message": "Again!", "tone": "FRIENDLY"}]}'</span>
</code></pre></div></div>

<p><a id="UPDATE"></a></p>

<h4 id="update">UPDATE</h4>

<p>UPDATE methods model updating an entity with a given key by setting its
value (overwriting the entire entity). UPDATE has side effects but is
idempotent. For example, repeating the same update operation has the
same effect as calling it once.</p>

<p>Resources may choose whether to allow an UPDATE of an entity that does
not already exist, in which case it should be created. This is different
from CREATE because the client specifies the key for the entity to be
created. Simple resources use UPDATE as a way to create the singleton
entity.</p>

<p>Resources providing the UPDATE resource method must override one of the
following method signatures.</p>

<p>For collection and association resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
</code></pre></div></div>

<p>For simple resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
</code></pre></div></div>

<p>For asynchronous resources:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">UpdateResponse</span><span class="o">&gt;</span> <span class="nf">update</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
</code></pre></div></div>

<p>The returned <code class="highlighter-rouge">UpdateResponse</code> object indicates the HTTP status code to
be returned.</p>

<p>@<code class="highlighter-rouge">RestMethod.Update</code> may be used to indicate a update method instead of
overriding the update method of a base class.</p>

<p><a id="BATCH_UPDATE"></a></p>

<h4 id="batch_update">BATCH_UPDATE</h4>

<p>BATCH_UPDATE methods model updating a set of entities with specified
keys by setting their values (overwriting each entity entirely).
BATCH_UPDATE has side effects but is idempotent. For example, repeating
the same batch update operation has the same effect as calling it once.</p>

<p>Resources may choose whether to allow BATCH_UPDATE for entities that do
not already exist, in which case each entity should be created. This is
different from BATCH_CREATE because the client specifies the keys for
the entities to be created.</p>

<p>Resources providing the BATCH_UPDATE resource method must override the
following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchUpdateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
</code></pre></div></div>

<p>An asynchronous resource must override the following method signature:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchUpdateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">BatchUpdateRequest</code> contains a map of entity key to entity value.</p>

<p>The returned <code class="highlighter-rouge">BatchUpdateResult</code> object indicates the <code class="highlighter-rouge">UpdateResponse</code>
for each key in the <code class="highlighter-rouge">BatchUpdateRequest</code>. In the case of failures,
<code class="highlighter-rouge">RestLiServiceException</code> objects may be added to the <code class="highlighter-rouge">BatchUpdateResult</code>
for the failed keys.</p>

<p>@<code class="highlighter-rouge">RestMethod.BatchUpdate</code> may be used to indicate a batch update method
instead of overriding the batchUpdate method of a base class.</p>

<p>Example of a batch update:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchUpdateRequest</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">UpdateResponse</span><span class="o">&gt;</span> <span class="n">responseMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">UpdateResponse</span><span class="o">&gt;();</span>
  <span class="k">for</span> <span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">entities</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">entrySet</span><span class="o">())</span>
  <span class="o">{</span>
    <span class="n">responseMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">update</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span>
    <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">()));</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;(</span><span class="n">responseMap</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="nc">Long</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Greeting</span> <span class="n">entity</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Greeting</span> <span class="n">g</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">g</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_404_NOT_FOUND</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="n">_db</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">entity</span><span class="o">);</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_204_NO_CONTENT</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><a id="PARTIAL_UPDATE"></a></p>

<h4 id="partial_update">PARTIAL_UPDATE</h4>

<p>PARTIAL_UPDATE methods model updating part of the entity with a given
key. PARTIAL_UPDATE has side effects. In general, it is not guaranteed
to be idempotent.</p>

<p>Resources providing the PARTIAL_UPDATE resource method must override
the following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">);</span>
</code></pre></div></div>

<p>An asynchronous resource must override the following method signature:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">UpdateResponse</span><span class="o">&gt;</span> <span class="nf">update</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">);</span>
</code></pre></div></div>

<p>The returned <code class="highlighter-rouge">UpdateResponse</code> object indicates the HTTP status code to
be returned.</p>

<p>Rest.li provides tools to make it easy to handle partial updates to your
resources. A typical update function should look something like this:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="nc">YourResource</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">YourResource</span> <span class="n">resource</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span> <span class="c1">// Retrieve the resource object</span>
  <span class="n">from</span> <span class="n">somewhere</span>
  <span class="nf">if</span> <span class="o">(</span><span class="n">resource</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_404_NOT_FOUND</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">try</span>
  <span class="o">{</span>
    <span class="nc">PatchApplier</span><span class="o">.</span><span class="na">applyPatch</span><span class="o">(</span><span class="n">resource</span><span class="o">,</span> <span class="n">patch</span><span class="o">);</span> <span class="c1">// Apply the patch.</span>
    <span class="c1">// Be sure to save the resource if necessary</span>
  <span class="o">}</span>
  <span class="k">catch</span> <span class="o">(</span><span class="nc">DataProcessingException</span> <span class="n">e</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_400_BAD_REQUEST</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_204_NO_CONTENT</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The PatchApplier automatically updates resources defined using the
Pegasus Data format. The Rest.li client classes provide support for
constructing patch requests, but here is an example update request using
curl:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST <span class="s1">'localhost:/fortunes/1'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"patch": {"$set": {"fortune": "you will strike it rich!"}}}'</span>
</code></pre></div></div>

<p>@<code class="highlighter-rouge">RestMethod.PartialUpdate</code> may be used to indicate a partial update
method instead of overriding the partialUpdate method of a base class.</p>

<h4 id="inspecting-partial-updates-to-selectively-update-fields-in-a-backing-store">Inspecting Partial Updates to Selectively Update Fields in a Backing Store</h4>

<p>It is possible to inspect the partial update and selectively write only
the changed fields to a store.</p>

<p>For example, to update only the street field of this address entity:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10th"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sunnyvale"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The partial update to change just the street field is:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"patch"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"$set"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9th"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>For the service code to selectively update just the street field (e.g.,
UPDATE addresses SET street=:street WHERE key=:key). The partial update
can be inspected and the selective update if only the street field is
changed:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="nc">YourResource</span><span class="o">&gt;</span> <span class="n">patchRequest</span><span class="o">)</span>
<span class="o">{</span>
  <span class="k">try</span>
  <span class="o">{</span>
    <span class="nc">DataMap</span> <span class="n">patch</span> <span class="o">=</span> <span class="n">patchRequest</span><span class="o">.</span><span class="na">getPatchDocument</span><span class="o">();</span>
    <span class="kt">boolean</span> <span class="n">selectivePartialUpdateApplied</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">patch</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="s">"address"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">patch</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="o">)</span>
    <span class="o">{</span>
      <span class="nc">DataMap</span> <span class="n">address</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="na">getDataMap</span><span class="o">(</span><span class="s">"address"</span><span class="o">);</span>
      <span class="k">if</span><span class="o">(</span><span class="n">address</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="s">"$set"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">address</span><span class="o">.</span><span class="na">size</span><span class="o">()</span>  <span class="mi">1</span><span class="o">)</span>
      <span class="o">{</span>
        <span class="nc">DataMap</span> <span class="n">set</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="na">getDataMap</span><span class="o">(</span><span class="s">"$set"</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">address</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="s">"street"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">address</span><span class="o">.</span><span class="na">size</span><span class="o">()</span>  <span class="mi">1</span><span class="o">)</span>
        <span class="o">{</span>
          <span class="nc">String</span> <span class="n">street</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"street"</span><span class="o">);</span>
          <span class="n">selectivePartialUpdateApplied</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
          <span class="c1">// update only the street, since its the only thing this patch requests to change</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">selectivePartialUpdateApplied</span>  <span class="kc">false</span><span class="o">)</span>
    <span class="o">{</span>
      <span class="c1">// no selective update available, update the whole record with</span>
      <span class="nc">PatchApplier</span> <span class="n">and</span> <span class="k">return</span> <span class="n">the</span> <span class="n">result</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="k">catch</span> <span class="o">(</span><span class="nc">DataProcessingException</span> <span class="n">e</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_400_BAD_REQUEST</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_204_NO_CONTENT</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="creating-partial-updates">Creating Partial Updates</h4>

<p>To create a request to modify field(s), PatchGenerator can be used, for
example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Fortune</span> <span class="n">fortune</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Fortune</span><span class="o">().</span><span class="na">setMessage</span><span class="o">(</span><span class="s">"Today's your lucky day."</span><span class="o">);</span>
<span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="nc">Fortune</span><span class="o">&gt;</span> <span class="n">patch</span> <span class="o">=</span> <span class="nc">PatchGenerator</span><span class="o">.</span><span class="na">diffEmpty</span><span class="o">(</span><span class="n">fortune</span><span class="o">);</span>
<span class="nc">Request</span><span class="o">&lt;</span><span class="nc">Fortune</span><span class="o">&gt;</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FortunesBuilders</span><span class="o">().</span><span class="na">partialUpdate</span><span class="o">().</span><span class="na">id</span><span class="o">(</span><span class="mi">1L</span><span class="o">).</span><span class="na">input</span><span class="o">(</span><span class="n">patch</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">PatchGenerator.diff(original, revised)</code> can also be used to create a
minimal partial update.</p>

<h4 id="returning-entity-in-partial_update-response">Returning entity in PARTIAL_UPDATE response</h4>

<p>By default, the patched entity is not returned in the PARTIAL_UPDATE response because
the client already has the patch data and possibly has the rest of the entity as well.
However, there are use cases where the server will attach additional data to the new entity or the user
simply doesn’t have the whole entity. Returning the entity in the PARTIAL_UPDATE response saves  the client
another GET request.</p>

<p>Starting in Rest.li version 24.0.0, we provide the developer the option to
return the patched entity. To use this feature, add a <code class="highlighter-rouge">@ReturnEntity</code>
annotation to the method that implements PARTIAL_UPDATE. The return type of the
method must be <code class="highlighter-rouge">UpdateEntityResponse</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ReturnEntity</span>
<span class="nd">@RestMethod</span><span class="o">.</span><span class="na">PartialUpdate</span>
<span class="kd">public</span> <span class="nc">UpdateEntityResponse</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="nf">partialUpdate</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">);</span>
</code></pre></div></div>

<p>An example resource method implementation is as follows, note that the return type will be  <code class="highlighter-rouge">UpdateEntityResponse</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ReturnEntity</span>
<span class="nd">@RestMethod</span><span class="o">.</span><span class="na">PartialUpdate</span>
<span class="kd">public</span> <span class="nc">UpdateEntityResponse</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">update</span><span class="o">(</span><span class="nc">Long</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Greeting</span> <span class="n">greeting</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>

  <span class="k">if</span> <span class="o">(</span><span class="n">greeting</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">RestLiServiceException</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_404_NOT_FOUND</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="k">try</span>
  <span class="o">{</span>
    <span class="nc">PatchApplier</span><span class="o">.</span><span class="na">applyPatch</span><span class="o">(</span><span class="n">greeting</span><span class="o">,</span> <span class="n">patch</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">catch</span> <span class="o">(</span><span class="nc">DataProcessingException</span> <span class="n">e</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">RestLiServiceException</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_400_BAD_REQUEST</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nc">UpdateEntityResponse</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_200_OK</span><span class="o">,</span> <span class="n">greeting</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>There may be circumstances in which you want to prevent the server from returning the entity, for example to reduce network traffic.
Here is an example curl request that makes use of the <a href="/rest.li/spec/return_entity#client-specified-behavior"><code class="highlighter-rouge">$returnEntity</code> query parameter</a> to indicate that the entity should not be returned:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST <span class="s1">'localhost:/greetings/1?$returnEntity=false'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"patch": {"$set": {"message": "Hello, world!"}}}'</span>
</code></pre></div></div>

<p><a id="BATCH_PARTIAL_UPDATE"></a></p>

<h4 id="batch_partial_update">BATCH_PARTIAL_UPDATE</h4>

<p>BATCH_PARTIAL_UPDATE methods model partial updates of multiple
entities given their keys. BATCH_PARTIAL_UPDATE has side effects. In
general, it is not guaranteed to be idempotent.</p>

<p>Resources providing the BATCH_PARTIAL_UPDATE resource method must
override the following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchPatchRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">patches</span><span class="o">);</span>
</code></pre></div></div>

<p>An asynchronous resource providing the BATCH_PARTIAL_UPDATE resource method must
override the following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchPatchRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">patches</span><span class="o">);</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">BatchPatchRequest</code> input contains a map of entity key to
<code class="highlighter-rouge">PatchRequest</code>.</p>

<p>The returned <code class="highlighter-rouge">BatchUpdateResult</code> object indicates the <code class="highlighter-rouge">UpdateResponse</code>
for each key in the <code class="highlighter-rouge">BatchPatchRequest</code>. In the case of failures,
<code class="highlighter-rouge">RestLiServiceException</code> objects may be added to the <code class="highlighter-rouge">BatchUpdateResult</code>
for the failed keys.</p>

<p>@<code class="highlighter-rouge">RestMethod.BatchPartialUpdate</code> may be used to indicate a batch partial
update method instead of overriding the batchPartialUpdate method of a
base class.</p>

<p>Example of a batch partial update:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchPatchRequest</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">entityUpdates</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">UpdateResponse</span><span class="o">&gt;</span> <span class="n">responseMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span>
  <span class="nc">UpdateResponse</span><span class="o">&gt;();</span>
  <span class="k">for</span> <span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;&gt;</span> <span class="n">entry</span> <span class="o">:</span>
  <span class="n">entityUpdates</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">entrySet</span><span class="o">())</span>
  <span class="o">{</span>
    <span class="n">responseMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">update</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span>
    <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">()));</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;(</span><span class="n">responseMap</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="nc">Long</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Greeting</span> <span class="n">g</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">g</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_404_NOT_FOUND</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="k">try</span>
  <span class="o">{</span>
    <span class="nc">PatchApplier</span><span class="o">.</span><span class="na">applyPatch</span><span class="o">(</span><span class="n">g</span><span class="o">,</span> <span class="n">patch</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="k">catch</span> <span class="o">(</span><span class="nc">DataProcessingException</span> <span class="n">e</span><span class="o">)</span>
  <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_400_BAD_REQUEST</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="n">_db</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">g</span><span class="o">);</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_204_NO_CONTENT</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="returning-entities-in-batch_partial_update-response">Returning entities in BATCH_PARTIAL_UPDATE response</h4>

<p>By default, the patched entities are not returned in the BATCH_PARTIAL_UPDATE response because
the client already has the patch data and possibly has the rest of the entities as well.
However, there are use cases where the server will attach additional data to the new entities or the user
simply doesn’t have the whole entities. Returning the entities in the BATCH_PARTIAL_UPDATE response saves the client
another GET request.</p>

<p>Starting in Rest.li version 25.0.5, we provide the developer the option to
return the patched entities. To use this feature, add a <code class="highlighter-rouge">@ReturnEntity</code>
annotation to the method that implements BATCH_PARTIAL_UPDATE. The return type of the
method must be <code class="highlighter-rouge">BatchUpdateEntityResult</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ReturnEntity</span>
<span class="nd">@RestMethod</span><span class="o">.</span><span class="na">BatchPartialUpdate</span>
<span class="kd">public</span> <span class="nc">BatchUpdateEntityResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchPartialUpdate</span><span class="o">(</span><span class="nc">BatchPatchRequest</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">patches</span><span class="o">);</span>
</code></pre></div></div>

<p>An example resource method implementation is as follows, note that the return type will be  <code class="highlighter-rouge">BatchUpdateEntityResult</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ReturnEntity</span>
<span class="nd">@RestMethod</span><span class="o">.</span><span class="na">BatchPartialUpdate</span>
<span class="kd">public</span> <span class="nc">BatchUpdateEntityResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">batchPartialUpdate</span><span class="o">(</span><span class="nc">BatchPatchRequest</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">patches</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">UpdateEntityResponse</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;&gt;</span> <span class="n">responseMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">RestLiServiceException</span><span class="o">&gt;</span> <span class="n">errorMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
  <span class="k">for</span> <span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">patches</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">entrySet</span><span class="o">())</span>
  <span class="o">{</span>
    <span class="k">try</span>
    <span class="o">{</span>
      <span class="nc">UpdateEntityResponse</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">updateEntityResponse</span> <span class="o">=</span> <span class="n">partialUpdate</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
      <span class="n">responseMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">updateEntityResponse</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">catch</span> <span class="o">(</span><span class="nc">RestLiServiceException</span> <span class="n">e</span><span class="o">)</span>
    <span class="o">{</span>
      <span class="n">errorMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nc">BatchUpdateEntityResult</span><span class="o">&lt;&gt;(</span><span class="n">responseMap</span><span class="o">,</span> <span class="n">errorMap</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>There may be circumstances in which you want to prevent the server from returning the entities, for example to reduce network traffic.
Here is an example curl request that makes use of the <a href="/rest.li/spec/return_entity#client-specified-behavior"><code class="highlighter-rouge">$returnEntity</code> query parameter</a> to indicate that the entity should not be returned:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST <span class="s1">'localhost:/greetings?ids=List(1)&amp;$returnEntity=false'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"entities":{"1":{"patch": {"$set": {"message": "Hello, world!"}}}}}'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'X-RestLi-Method: BATCH_PARTIAL_UPDATE'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'X-RestLi-Protocol-Version: 2.0.0'</span>
</code></pre></div></div>

<p><a id="DELETE"></a></p>

<h4 id="delete">DELETE</h4>

<p>DELETE methods model deleting (removing) an entity with a given key on
collection and association resources or without a key on simple
resources. DELETE has side effects but is idempotent.</p>

<p>Resources providing the DELETE resource method must override one of the
following method signatures.</p>

<p>For collection and association resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">delete</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
</code></pre></div></div>

<p>For simple resources:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">delete</span><span class="o">();</span>
</code></pre></div></div>

<p>For asynchronous resources:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">UpdateResponse</span><span class="o">&gt;</span> <span class="nf">delete</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
</code></pre></div></div>

<p>The returned <code class="highlighter-rouge">UpdateResponse</code> object indicates the HTTP status code to
be returned.</p>

<p>@<code class="highlighter-rouge">RestMethod.Delete</code> may be used to indicate a delete method instead of
overriding the delete method of a base class.</p>

<p><a id="BATCH_DELETE"></a></p>

<h4 id="batch_delete">BATCH_DELETE</h4>

<p>BATCH_DELETE methods model deleting (removing) multiple entities given
their keys. BATCH_DELETE has side effects but is idempotent.</p>

<p>Resources providing the BATCH_DELETE resource method must override the
following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchDelete</span><span class="o">(</span><span class="nc">BatchDeleteRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
</code></pre></div></div>

<p>Asynchronous resources providing the BATCH_DELETE resource method must override the
following method signature:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Task</span><span class="o">&lt;</span><span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;&gt;</span> <span class="nf">batchDelete</span><span class="o">(</span><span class="nc">BatchDeleteRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">BatchDeleteRequest</code> input contains the list of keys to be deleted.
<code class="highlighter-rouge">BatchDeleteRequest</code> accepts a generic type parameter <code class="highlighter-rouge">V</code> for future
extension.</p>

<p>The returned <code class="highlighter-rouge">BatchUpdateResult</code> object indicates the <code class="highlighter-rouge">UpdateResponse</code>
for each key in the <code class="highlighter-rouge">BatchDeleteRequest</code>. In the case of failures,
<code class="highlighter-rouge">RestLiServiceException</code> objects may be added to the <code class="highlighter-rouge">BatchUpdateResult</code>
for the failed keys.</p>

<p>@<code class="highlighter-rouge">RestMethod.BatchDelete</code> may be used to indicate a batch delete method
instead of overriding the batchDelete method of a base class.</p>

<p>Example of a batch delete:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="nf">batchDelete</span><span class="o">(</span><span class="nc">BatchDeleteRequest</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">deleteRequest</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">UpdateResponse</span><span class="o">&gt;</span> <span class="n">responseMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">UpdateResponse</span><span class="o">&gt;();</span>
  <span class="k">for</span> <span class="o">(</span><span class="nc">Long</span> <span class="n">id</span> <span class="o">:</span> <span class="n">deleteRequest</span><span class="o">.</span><span class="na">getKeys</span><span class="o">())</span>
  <span class="o">{</span>
    <span class="n">responseMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">delete</span><span class="o">(</span><span class="n">id</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Greeting</span><span class="o">&gt;(</span><span class="n">responseMap</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">delete</span><span class="o">(</span><span class="nc">Long</span> <span class="n">key</span><span class="o">)</span>
<span class="o">{</span>
  <span class="kt">boolean</span> <span class="n">removed</span> <span class="o">=</span> <span class="n">_db</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">key</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nf">UpdateResponse</span><span class="o">(</span><span class="n">removed</span> <span class="o">?</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_204_NO_CONTENT</span> <span class="o">:</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_404_NOT_FOUND</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><a id="ACTION"></a></p>

<h4 id="action">ACTION</h4>

<p>ACTION methods are very flexible and do not specify any standard
behavior.</p>

<p>Resources may provide zero or more ACTION resource methods. Each action
must be annotated with the <code class="highlighter-rouge">@Action</code> annotation.</p>

<p>The <code class="highlighter-rouge">@Action</code> annotation supports the following parameters:</p>

<ul>
  <li><code class="highlighter-rouge">name</code> Required, the name of the action resource method.</li>
  <li><code class="highlighter-rouge">resourceLevel</code> Optional, defaults to <code class="highlighter-rouge">ResourceLevel.ANY</code>, which
indicates that the action is defined directly on the containing
resource and does not support an entity key as a URI parameter.
<code class="highlighter-rouge">ResourceLevel.COLLECTION</code> indicates that the action is defined on
the containing association or collection resource and does not
support an entity key as a URI parameter. <code class="highlighter-rouge">ResourceLevel.ENTITY</code>
indicates that the action is defined on the entity and it requires
an entity key as a URI parameter when the containing resource is an
association or collection resource. If the containing resource is a
simple resource <code class="highlighter-rouge">ResourceLevel.ENTITY</code> indicates that the action is
defined directly on the resource and does not support an entity key
as a URI parameter.</li>
  <li><code class="highlighter-rouge">returnTyperef</code> Optional, defaults to no typeref. Indicates a
Typeref to be used in the IDL for the action’s return parameter.
Useful for actions that return primitive types.</li>
</ul>

<p>Each parameter to an action method must be annotated with
<code class="highlighter-rouge">@ActionParam</code>, which takes the following annotation parameters:</p>

<ul>
  <li><code class="highlighter-rouge">value</code> Required, string name for the action parameter. If this is
the only annotation, parameter, it may be specified without being
explicitly named, for example, @<code class="highlighter-rouge">ActionParam("paramName")</code>.</li>
  <li><code class="highlighter-rouge">typeref</code> Optional, Typeref to be used in the IDL for the parameter.</li>
</ul>

<p>Parameters of action methods may also be annotated with <code class="highlighter-rouge">@Optional</code>,
which indicates that the parameter is not required in the request. The
<code class="highlighter-rouge">@Optional</code> annotation may specify a String value, which specifies the
default value to be used if the parameter is not provided in the
request. If the method parameter is of primitive type, a default value
must be specified in the <code class="highlighter-rouge">@Optional</code> annotation.</p>

<p>Valid parameter types and return types for action are:</p>

<ul>
  <li><code class="highlighter-rouge">String</code></li>
  <li><code class="highlighter-rouge">boolean</code> / <code class="highlighter-rouge">Boolean</code></li>
  <li><code class="highlighter-rouge">int</code> / <code class="highlighter-rouge">Integer</code></li>
  <li><code class="highlighter-rouge">long</code> / <code class="highlighter-rouge">Long</code></li>
  <li><code class="highlighter-rouge">float</code> / <code class="highlighter-rouge">Float</code></li>
  <li><code class="highlighter-rouge">double</code> / <code class="highlighter-rouge">Double</code></li>
  <li><code class="highlighter-rouge">ByteString</code></li>
  <li>A Pegasus Enum (any enum defined in a <code class="highlighter-rouge">.pdl</code> schema)</li>
  <li><code class="highlighter-rouge">RecordTemplate</code> or a subclass of <code class="highlighter-rouge">RecordTemplate</code> generated from a
record schema</li>
  <li><code class="highlighter-rouge">FixedTemplate</code> or a subclass of <code class="highlighter-rouge">FixedTemplate</code> generated from a
fixed schema</li>
  <li><code class="highlighter-rouge">AbstractArrayTemplate</code> or a subclass of <code class="highlighter-rouge">AbstractArrayTemplate</code>,
for example, <code class="highlighter-rouge">StringArray</code>, <code class="highlighter-rouge">LongArray</code>, and so on.</li>
  <li><code class="highlighter-rouge">AbstractMapTemplate</code> or a subclass of <code class="highlighter-rouge">AbstractMapTemplate</code>, for
example, <code class="highlighter-rouge">StringMap</code>, <code class="highlighter-rouge">LongMap</code>, and so on.</li>
  <li>Custom types</li>
</ul>

<p>Similar to <code class="highlighter-rouge">GetResult&lt;V&gt;</code>, since 1.5.8, Rest.li supports an
<code class="highlighter-rouge">ActionResult&lt;V&gt;</code> wrapper return type that allows you to specify an
arbitrary HTTP status code for the response.</p>

<p>Simple example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Action</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"action"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">doAction</span><span class="o">();</span>
</code></pre></div></div>

<p>A more complex example, illustrating multiple parameters:
(Note this action is defined on the entity level, and the entity Key is accessed from the conxt)</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Action</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"sendTestAnnouncement"</span><span class="o">,</span><span class="n">resourceLevel</span><span class="o">=</span> <span class="nc">ResourceLevel</span><span class="o">.</span><span class="na">ENTITY</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendTestAnnouncement</span><span class="o">(</span><span class="nd">@ActionParam</span><span class="o">(</span><span class="s">"subject"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">subject</span><span class="o">,</span> 
                                 <span class="nd">@ActionParam</span><span class="o">(</span><span class="s">"message"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">message</span><span class="o">,</span> 
                                 <span class="nd">@ActionParam</span><span class="o">(</span><span class="s">"emailAddress"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">emailAddress</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Long</span> <span class="n">entityKey</span> <span class="o">=</span> <span class="n">getContext</span><span class="o">().</span><span class="na">getPathKeys</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">_resourceName</span> <span class="o">+</span> <span class="s">"Id"</span><span class="o">);</span>
  <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><a id="ActionParamVQueryParam"></a></p>

<h4 id="actionparam-vs-queryparam">ActionParam vs. QueryParam</h4>

<p><code class="highlighter-rouge">@ActionParam</code> and <code class="highlighter-rouge">@QueryParam</code> are used in different methods.
<code class="highlighter-rouge">@ActionParam</code> is only allowed in Action methods, while <code class="highlighter-rouge">@QueryParam</code> is
allowed in all non-Action methods. Besides, they are also different in
terms of how the parameter data is sent to the server. If a parameter is
annotated with <code class="highlighter-rouge">@QueryParam</code>, the information will be sent in the
request url. If a parameter is annotated with <code class="highlighter-rouge">@ActionParam</code>, the
information will be sent in the request body. Therefore, one advantage
of using <code class="highlighter-rouge">@ActionParam</code> would be that the sent parameter can be encoded.
One disadvantage is that the purpose of the request itself can become
less clear if one only examines the url.</p>

<p><a id="wiki-ReturningNulls"></a></p>

<h4 id="returning-nulls">Returning Nulls</h4>

<p>Resource methods should never explicitly return <code class="highlighter-rouge">null</code>. If the Rest.li
framework detects this, it will return an HTTP <code class="highlighter-rouge">500</code> back to the client
with a message indicating ‘Unexpected null encountered’. The only
exceptions to this rule are ACTION and GET. If an ACTION resource method
returns <code class="highlighter-rouge">null</code>, the rest.li framework will return an HTTP <code class="highlighter-rouge">200</code>. If a
GET returns <code class="highlighter-rouge">null</code>, the Rest.li framework will return an HTTP <code class="highlighter-rouge">404</code>.</p>

<p>Also note that the HTTP <code class="highlighter-rouge">500</code> will also be generated by the Rest.li
framework if subsequent data structures inside of resource method
responses are null or contain null. This applies to any data structure
that is not a RecordTemplate. For example, all of the the following
would cause an HTTP <code class="highlighter-rouge">500</code> to be returned. Note this list is not
exhaustive:</p>

<ul>
  <li>A <code class="highlighter-rouge">BatchCreateResult</code> returning a <code class="highlighter-rouge">null</code> results list.</li>
  <li>A <code class="highlighter-rouge">BatchCreateResult</code> returning a valid list that as a <code class="highlighter-rouge">null</code>
element inside of it.</li>
  <li>A <code class="highlighter-rouge">CreateResponse</code> returning a <code class="highlighter-rouge">null</code> for the <code class="highlighter-rouge">HttpStatus</code>.</li>
  <li>A <code class="highlighter-rouge">BatchUpdateResult</code> returning a <code class="highlighter-rouge">null</code> key in the results map.</li>
  <li>A <code class="highlighter-rouge">BatchUpdateResult</code> returning a <code class="highlighter-rouge">null</code> errors map.</li>
  <li>A <code class="highlighter-rouge">BatchUpdateResult</code> returning a valid errors map, but with a
<code class="highlighter-rouge">null</code> key or <code class="highlighter-rouge">null</code> value inside of it.</li>
</ul>

<p>It is good practice to make sure that <code class="highlighter-rouge">null</code> is never returned in any
part of resource method responses, with the exception of RecordTemplate
classes, ACTION methods and GET methods.</p>

<p><a id="wiki-ResourceContext"></a></p>

<h2 id="resourcecontext">ResourceContext</h2>

<p><code class="highlighter-rouge">ResourceContext</code> provides access to the context of the current request.
<code class="highlighter-rouge">ResourceContext</code> is injected into resources that implement the
<code class="highlighter-rouge">BaseResource</code> interface, by calling <code class="highlighter-rouge">setContext()</code>.</p>

<p>For resources extending <code class="highlighter-rouge">CollectionResourceTemplate</code>,
<code class="highlighter-rouge">AssociationResourceTemplate</code>, or <code class="highlighter-rouge">ResourceContextHolder</code>, the current
context is available by calling <code class="highlighter-rouge">getContext()</code>.</p>

<p><code class="highlighter-rouge">ResourceContext</code> provides methods to access the raw request, as well as
parsed values from the request. <code class="highlighter-rouge">ResourceContext</code> also provides some
control over the generated response, such as the ability to set response
headers.</p>

<p><a id="wiki-ResourceTemplates"></a></p>

<h2 id="resource-templates">Resource Templates</h2>

<p>Resource Templates provide convenient methods for implementing resource
classes by extending them. Subclasses may selectively override relevant
methods and for methods that are not overridden, the framework will
recognize that your resource does not support this method and will
return a 404 if clients attempt to invoke it. Note that unsupported
methods will be omitted from your resources IDL (see <a href="/rest.li/user_guide/restli_client#restspec-idl">Restspec IDL</a>
for details).</p>

<h4 id="collectionresourcetemplate">CollectionResourceTemplate</h4>

<p><code class="highlighter-rouge">CollectionResourceTemplate</code> provides a convenient base class for
collection resources. <code class="highlighter-rouge">CollectionResourceTemplate</code> defines methods for
all of the CRUD operations. Subclasses may also implement FINDER, BATCH_FINDER and
ACTION methods by annotating as described above. The asynchronous collection resource templates are <code class="highlighter-rouge">CollectionResourceTaskTemplate</code> and <code class="highlighter-rouge">CollectionResourceAsyncTemplate</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">CreateResponse</span> <span class="nf">create</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
<span class="kd">public</span> <span class="no">V</span> <span class="nf">get</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span><span class="n">batchGet</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchUpdateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchPatchRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">patches</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">delete</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchDelete</span><span class="o">(</span><span class="nc">BatchDeleteRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
</code></pre></div></div>

<h4 id="simpleresourcetemplate">SimpleResourceTemplate</h4>

<p><code class="highlighter-rouge">SimpleResourceTemplate</code> provides a convenient base class for simple
resources. <code class="highlighter-rouge">SimpleResourceTemplate</code> defines methods for GET, UPDATE, and
DELETE methods. Subclasses may also implement ACTION methods by
annotating as described above. The asynchronous simple resource templates are <code class="highlighter-rouge">SimpleResourceTaskTemplate</code> and <code class="highlighter-rouge">SimpleResourceAsyncTemplate</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="no">V</span> <span class="nf">get</span><span class="o">();</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">delete</span><span class="o">();</span>
</code></pre></div></div>

<h4 id="associationresourcetemplate">AssociationResourceTemplate</h4>

<p><code class="highlighter-rouge">AssociationResourceTemplate</code> provides a convenient base class for
association resources. <code class="highlighter-rouge">AssociationResourceTemplate</code> defines methods for
all of the CRUD operations except CREATE. Association resources should
implement CREATE by providing up-sert semantics on UPDATE. Subclasses
may also implement FINDER, BATCH_FINDER and ACTION methods by annotating as described
above. The asynchronous association resource templates are <code class="highlighter-rouge">AssociationResourceTaskTemplate</code> and <code class="highlighter-rouge">AssociationResourceAsyncTemplate</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">CreateResponse</span> <span class="nf">create</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span><span class="n">batchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
<span class="kd">public</span> <span class="no">V</span> <span class="nf">get</span><span class="o">(</span><span class="nc">CompoundKey</span> <span class="n">key</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchGet</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="nc">CompoundKey</span> <span class="n">key</span><span class="o">,</span> <span class="no">V</span> <span class="n">entity</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span><span class="n">batchUpdate</span><span class="o">(</span><span class="nc">BatchUpdateRequest</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">update</span><span class="o">(</span><span class="nc">CompoundKey</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchUpdate</span><span class="o">(</span><span class="nc">BatchPatchRequest</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">patches</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">delete</span><span class="o">(</span><span class="nc">CompoundKey</span> <span class="n">key</span><span class="o">);</span>
<span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchDelete</span><span class="o">(</span><span class="nc">BatchDeleteRequest</span><span class="o">&lt;</span><span class="nc">CompoundKey</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
</code></pre></div></div>

<p><a id="wiki-FreeFormResources"></a></p>

<h2 id="free-form-resources">Free-Form Resources</h2>

<p>Resource Templates provide a convenient way to implement the recommended
signatures for the basic CRUD operations (CREATE, GET, UPDATE,
PARTIAL_UPDATE, DELETE, and respective batch operations). When
possible, we recommend using the resource templates to ensure that your
interface remains simple and uniform.</p>

<p>However, it is sometimes necessary to add custom parameters to CRUD
operations. In these cases, the fixed signatures of resource templates
are too constraining. The solution is to create a free-form resource by
implementing the corresponding marker interface for your resource and
annotating CRUD methods with @<code class="highlighter-rouge">RestMethod.*</code> annotations.The
<code class="highlighter-rouge">KeyValueResource</code> interface is the marker interface for collection and
association resources where the <code class="highlighter-rouge">SingleObjectResource</code> interface is the
marker interface for simple resources.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FreeFormCollectionResource</span> <span class="kd">implements</span> <span class="nc">KeyValueResource</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Create</span>
  <span class="kd">public</span> <span class="nc">CreateResponse</span> <span class="nf">myCreate</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">BatchCreate</span>
  <span class="kd">public</span> <span class="nc">BatchCreateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">myBatchCreate</span><span class="o">(</span><span class="nc">BatchCreateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
  <span class="kd">public</span> <span class="no">V</span> <span class="nf">myGet</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">GetAll</span>
  <span class="kd">public</span> <span class="nc">CollectionResult</span><span class="o">&lt;</span><span class="no">V</span><span class="o">,</span> <span class="no">M</span><span class="o">&gt;</span> <span class="nf">myGetAll</span><span class="o">(</span><span class="nd">@Context</span> <span class="nc">PagingContext</span> <span class="n">pagingContex</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">BatchGet</span>
  <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">myBatchGet</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Update</span>
  <span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">myUpdate</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="no">V</span> <span class="n">entity</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">BatchUpdate</span>
  <span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">myBatchUpdate</span><span class="o">(</span><span class="nc">BatchUpdateRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">entities</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">PartialUpdate</span>
  <span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">myUpdate</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="nc">PatchRequest</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">patch</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">BatchPartialUpdate</span>
  <span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">myBatchUpdate</span><span class="o">(</span><span class="nc">BatchPatchRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">patches</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Delete</span>
  <span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">myDelete</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">BatchDelete</span>
  <span class="kd">public</span> <span class="nc">BatchUpdateResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">myBatchDelete</span><span class="o">(</span><span class="nc">BatchDeleteRequest</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FreeFormSimpleResource</span> <span class="kd">implements</span> <span class="nc">SingleObjectResource</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
  <span class="kd">public</span> <span class="no">V</span> <span class="nf">myGet</span><span class="o">();</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Update</span>
  <span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">myUpdate</span><span class="o">(</span><span class="no">V</span> <span class="n">entity</span><span class="o">);</span>

  <span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Delete</span>
  <span class="kd">public</span> <span class="nc">UpdateResponse</span> <span class="nf">myDelete</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The advantage of explicitly annotating each resource method is that you
can add custom query parameters (see description of <code class="highlighter-rouge">@QueryParam</code> for
FINDER resource method) and take advantage of wrapper return types.
Custom query parameters must be defined <strong>after</strong> the fixed parameters
shown above.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
<span class="kd">public</span> <span class="no">V</span> <span class="nf">myGet</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="nd">@QueryParam</span><span class="o">(</span><span class="s">"myParam"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">myParam</span><span class="o">);</span>

<span class="nd">@RestMethod</span><span class="o">.</span><span class="na">Get</span>
<span class="kd">public</span> <span class="nc">GetResult</span><span class="o">&lt;</span><span class="no">V</span><span class="o">&gt;</span> <span class="nf">getWithStatus</span><span class="o">(</span><span class="no">K</span> <span class="n">key</span><span class="o">);</span>
</code></pre></div></div>

<p>Note that each resource may only provide one implementation of each CRUD
method (for example, it is invalid to annotate two different methods with
@<code class="highlighter-rouge">RestMethod.Get</code>).</p>

<h3 id="things-to-remember-about-free-form-resources">Things to Remember about Free-Form Resources</h3>

<ul>
  <li>Free-form resources allow you to add query parameters to CRUD
methods.</li>
  <li>Resource Templates should be used whenever possible.</li>
  <li>Free-form resources must implement one of the <code class="highlighter-rouge">KeyValueResource</code> and
<code class="highlighter-rouge">SingleObjectResource</code> marker interfaces.</li>
  <li>Methods in free-form resources must be annotated with appropriate
@<code class="highlighter-rouge">RestMethod.*</code> annotations.</li>
  <li>Methods in free-form resources must use the same return type and
initial signature as the corresponding Resource Template method.</li>
  <li>Methods in free-form resources may add additional parameters
<strong>after</strong> the fixed parameters.</li>
  <li>Free-form resources may not define multiple implementations of the
same resource method.</li>
</ul>

<p><a id="wiki-ReturningErrors"></a></p>

<h2 id="returning-errors">Returning Errors</h2>

<p>There are several mechanisms available for resources to report errors to
be returned to the caller. Regardless of which mechanism is used,
resources should be aware of the resulting HTTP status code and ensure
that meaningful status codes are used. Remember that <code class="highlighter-rouge">4xx</code> codes should
be used to report client errors (errors that the client may be able to
resolve), and <code class="highlighter-rouge">5xx</code> codes should be used to report server errors.</p>

<h4 id="return-null-for-get">Return <code class="highlighter-rouge">null</code> for GET</h4>

<p>If a resource method returns <code class="highlighter-rouge">null</code> for GET, the framework will
automatically generate a <code class="highlighter-rouge">404</code> response to be sent to the client.</p>

<p>Note that returning <code class="highlighter-rouge">null</code> for resource methods is generally forbidden
with the exception of GET and ACTION. Returning a <code class="highlighter-rouge">null</code> for a GET
returns a 404 and returning a <code class="highlighter-rouge">null</code> for an ACTION returns 200.</p>

<p>Returning a <code class="highlighter-rouge">null</code> for any other type of resource method will cause the
rest.li framework to return an HTTP <code class="highlighter-rouge">500</code> to be sent back to the client
with a message indicating ‘Unexpected null encountered’. This is
described in detail above at <a href="#returning-nulls">Returning
Nulls</a></p>

<h4 id="return-any-http-status-code-in-a-createresponseupdateresponse">Return Any HTTP Status Code in a CreateResponse/UpdateResponse</h4>

<p><code class="highlighter-rouge">CreateResponse</code> and <code class="highlighter-rouge">UpdateResponse</code> allow an <a href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes">Http Status
Code</a> to be
provided. Status codes in the <code class="highlighter-rouge">4xx</code> and <code class="highlighter-rouge">5xx</code> ranges may be used to
report errors.</p>

<h4 id="throw-restliserviceexception-to-return-a-4xx5xx-http-status-code">Throw RestLiServiceException to Return a 4xx/5xx HTTP Status Code</h4>

<p>The framework defines a special exception class,
<code class="highlighter-rouge">RestLiServiceException</code>, which contains an <a href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes">Http Status
Code</a> field, as
well as other fields that are returned to the client in the body of the
HTTP response. Resources may throw <code class="highlighter-rouge">RestLiServiceException</code> or a
subclass to prompt the framework to return an HTTP error response.</p>

<h4 id="throw-another-exception">Throw Another Exception</h4>

<p>All exceptions originating in application code are caught by the
framework and used to generate an HTTP response. If the exception does
not extend <code class="highlighter-rouge">RestLiServiceException</code>, an HTTP <code class="highlighter-rouge">500</code> response will be
sent.</p>

<h4 id="return-errors-as-part-of-a-batchresult">Return Errors as Part of a BatchResult</h4>

<p>BATCH_GET methods may return errors for individual items as part of a
<code class="highlighter-rouge">BatchResult</code> object. Each error is represented as a <code class="highlighter-rouge">RestLiServiceException</code>
object. In this case, the overall status will still be an HTTP <code class="highlighter-rouge">200</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchGet</span><span class="o">((</span><span class="nc">Set</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">)</span>
<span class="o">{</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="o">...</span>
  <span class="nc">Map</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="nc">RestLiServiceException</span><span class="o">&gt;</span> <span class="n">errors</span> <span class="o">=</span> <span class="o">...</span>
  <span class="o">...</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nf">BatchResult</span><span class="o">(</span><span class="n">results</span><span class="o">,</span> <span class="n">errors</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>If you want to return an error response with an overall status of <code class="highlighter-rouge">4xx</code> or <code class="highlighter-rouge">5xx</code>,
then you can do this by throwing a <code class="highlighter-rouge">RestLiServiceException</code> in the resource method.
In this case, the response will be an error response and won’t contain any batch
information.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">BatchResult</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span> <span class="no">V</span><span class="o">&gt;</span> <span class="nf">batchGet</span><span class="o">((</span><span class="nc">Set</span><span class="o">&lt;</span><span class="no">K</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">)</span>
<span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="nf">RestLiServiceException</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">S_400_BAD_REQUEST</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The same logic applies to BATCH_UPDATE, BATCH_PARTIAL_UPDATE, and BATCH_DELETE.</p>

<p>For BATCH_FINDER method, it may return errors for individual criteria as part of a <code class="highlighter-rouge">BatchFinderResult</code> object.
Each error is represented as a RestLiServiceException object when it cannot find a corresponding
response for that search criteria Or the developer can put the customized RestLiServiceException into the BatchFinderResult . 
In this case, the overall status will still be an HTTP 200.</p>

<h3 id="handling-errors-on-the-client">Handling Errors on the Client</h3>

<p>When making requests using <code class="highlighter-rouge">RestClient</code>, a <code class="highlighter-rouge">ResponseFuture</code> is always
returned, as shown in this example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ResponseFuture</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">=</span> <span class="n">restClient</span><span class="o">.</span><span class="na">sendRequest</span><span class="o">(</span><span class="k">new</span> <span class="nc">GreetingsBuilders</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">id</span><span class="o">(</span><span class="mi">1L</span><span class="o">));</span>
</code></pre></div></div>

<p>This future might contain an error response. When calling
<code class="highlighter-rouge">ResponseFuture.getResponse()</code>, the default behavior is for a
<code class="highlighter-rouge">RestLiResponseException</code> to be thrown if the response contains an error
response. Error responses are all 400 and 500 series HTTP status code,
as shown in this example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span>
<span class="o">{</span>
  <span class="nc">Greeting</span> <span class="n">greeting</span> <span class="o">=</span> <span class="n">restClient</span><span class="o">.</span><span class="na">sendRequest</span><span class="o">(</span><span class="k">new</span> <span class="nc">GreetingsBuilders</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">id</span><span class="o">(</span><span class="mi">1L</span><span class="o">)).</span><span class="na">getResponseEntity</span><span class="o">();</span>
  <span class="c1">// handle successful response</span>
<span class="o">}</span>
<span class="k">catch</span> <span class="o">(</span><span class="nc">RestLiResponseException</span> <span class="n">e</span><span class="o">)</span>
<span class="o">{</span>
  <span class="k">if</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getStatus</span><span class="o">()</span> <span class="o">==</span> <span class="mi">400</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// handle 400</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="c1">// ... handle other status codes or rethrow</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Alternatively, <code class="highlighter-rouge">ErrorHandlingBehavior.TREAT_SERVER_ERROR_AS_SUCCESS</code> can
be set when making a request. If set, <code class="highlighter-rouge">.getResponse()</code> will <strong>not</strong>
throw <code class="highlighter-rouge">RestLiResponseException</code> even if the response contains a 400 or
500 series HTTP status code, as shown in this example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Response</span><span class="o">&lt;</span><span class="nc">Greeting</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="n">restClient</span><span class="o">.</span><span class="na">sendRequest</span><span class="o">(</span><span class="k">new</span> <span class="nc">GreetingsBuilders</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">id</span><span class="o">(</span><span class="mi">1L</span><span class="o">),</span>
                                                     <span class="nc">ErrorHandlingBehavior</span><span class="o">.</span><span class="na">TREAT_SERVER_ERROR_AS_SUCCESS</span><span class="o">).</span><span class="na">getResponse</span><span class="o">();</span>
<span class="k">if</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatus</span><span class="o">()</span> <span class="o">==</span> <span class="mi">200</span><span class="o">)</span>
<span class="o">{</span>
  <span class="c1">// handle successful response</span>
<span class="o">}</span>
<span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatus</span><span class="o">()</span> <span class="o">==</span> <span class="mi">404</span><span class="o">)</span>
<span class="o">{</span>
  <span class="c1">// handle 404</span>
<span class="o">}</span>
<span class="k">else</span>
<span class="o">{</span>
  <span class="c1">// ... handle other status codes or rethrow</span>
<span class="o">}</span>
</code></pre></div></div>

<p>However because error responses do not contain an entity, calling
<code class="highlighter-rouge">ResponseFuture.getResponseEntity()</code> or <code class="highlighter-rouge">Response.getEntity()</code> will
<strong>always</strong> throw a <code class="highlighter-rouge">RestLiResponseException</code> for 400 or 500 series HTTP
status code, regardless of <code class="highlighter-rouge">ErrorHandlingBehavior</code>.</p>

<h3 id="configuring-how-errors-are-represented-in-an-http-response">Configuring How Errors are Represented in an HTTP Response</h3>

<p>By default, Rest.li returns an extensive HTTP error response that
includes:</p>

<ul>
  <li>HTTP Status Code (manditory)</li>
  <li><code class="highlighter-rouge">X-LinkedIn-Error-Response</code> header (this will be renamed to
<code class="highlighter-rouge">X-RestLi-Error-Response</code> shortly)</li>
  <li>A response body containing:
    <ul>
      <li>A full stack trace</li>
      <li>A service error code (optional)</li>
      <li>Application specific error details (optional)</li>
    </ul>
  </li>
</ul>

<p>The error response format configured to return only a subset of these
parts using RestLiConfig, as shown in this example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">restLiConfig</span><span class="o">.</span><span class="na">setErrorResponseFormat</span><span class="o">(</span><span class="nc">ErrorResponseFormat</span><span class="o">.</span><span class="na">MESSAGE_AND_DETAILS</span><span class="o">);</span>
</code></pre></div></div>

<p>When Rest.li server application code throws an exception, if the
exception is of type RestLiServiceException, then the error message
provided by the RestLiServiceException is used for the error message in
the HTTP response. However if any other Java exception is thrown,
Rest.li automatically provides a default error message of “Error in
application code” in the error response. This default error message may
be customized via RestLiConfig as well, as shown in this example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">restLiConfig</span><span class="o">.</span><span class="na">setInternalErrorMessage</span><span class="o">(</span><span class="s">"Internal error, please try again later."</span><span class="o">);</span>
</code></pre></div></div>

<p>See <a href="/rest.li/spec/service_errors#error-responses">this page</a> for more information on
error responses in Rest.li.</p>

<p><a id="wiki-Projections"></a></p>

<h2 id="field-projection">Field Projection</h2>

<p>Rest.li provides built-in support for field projections, for example the
structural filtering of responses. The support includes <a href="/rest.li/How-to-use-projections-in-Java">Java Projection Bindings</a>
and a <a href="/rest.li/Projections">JSON Projection wire protocol</a>. The
projection is applied separately to each entity object in the response
(i.e., to the value-type of the CollectionResource or
AssociationResource). If the invoked method is a FINDER that returns a
List, the projection is applied to each element of the list
individually. Likewise, if the invoked method is a BATCH_GET that
returns a Map&lt;K, V&gt;, the projection is applied to each value in the
map individually. Project can also be applied to CREATE and
BATCH_CREATE when the newly returned entity or entities are returned.</p>

<p>For resource methods that return CollectionResult, the Rest.li framework
also provides the ability to project the Metadata and as well as the
Paging that is sent back to the client. More info on Collection
Pagination is provided below.</p>

<p>The Rest.li server framework recognizes the “fields”, “metadataFields”,
or “pagingFields” query parameters in the request. If available, the
Rest.li framework then parses each of these as individual <code class="highlighter-rouge">MaskTrees</code>.
The resulting <code class="highlighter-rouge">MaskTrees</code> are available through the ResourceContext (see
above) or directly to the resource methods.</p>

<p>Projection can also be toggled between <code class="highlighter-rouge">AUTOMATIC</code> and <code class="highlighter-rouge">MANUAL</code>. The
latter precludes the Rest.li framework from performing any projection
while the former forces the Rest.li framework to perform the projection.</p>

<p>Additional details are described in <a href="/rest.li/How-to-use-projections-in-Java">How to Use Projections in Java</a></p>

<p><a id="wiki-Pagination"></a></p>

<h2 id="collection-pagination">Collection Pagination</h2>

<p>Rest.li provides helper methods to implement collection pagination, but
it requires each resource to implement core pagination logic itself.
Rest.li pagination uses positional indices to specify page boundaries.</p>

<p>The Rest.li server framework automatically recognizes the <code class="highlighter-rouge">"start"</code> and
<code class="highlighter-rouge">"count"</code> parameters for pagination, parses the values of these
parameters, and makes them available through a <code class="highlighter-rouge">PagingContext</code> object.
FINDER methods may request the <code class="highlighter-rouge">PagingContext</code> by declaring a method
parameter annotated with <code class="highlighter-rouge">@Context</code> (see above).</p>

<p>FINDER methods are expected to honor the <code class="highlighter-rouge">PagingContext</code> requirements,
for example, to return only the subset of results with logical indices
<code class="highlighter-rouge">&gt;= start</code> and <code class="highlighter-rouge">&lt; start+count</code>.</p>

<p>The Rest.li server framework also includes support for returning
CollectionMetadata as part of the response. CollectionMetadata includes
pagination info such as:</p>

<ul>
  <li>The requested <code class="highlighter-rouge">start</code></li>
  <li>The requested <code class="highlighter-rouge">count</code></li>
  <li>The <code class="highlighter-rouge">total</code> number of results (before pagination)</li>
  <li>Links to the previous and next pages of results</li>
</ul>

<p>FINDER methods that can provide the <code class="highlighter-rouge">total</code> number of matching results
should do so by returning an appropriate <code class="highlighter-rouge">CollectionResult</code> or
<code class="highlighter-rouge">BasicCollectionResult</code> object.</p>

<p>In order for the Rest.li framework to automatically construct <code class="highlighter-rouge">Link</code> objects,
certain conditions must be met. For both previous and next links, the <code class="highlighter-rouge">count</code>
in the request must be greater than <code class="highlighter-rouge">0</code>. For links to the previous page,
<code class="highlighter-rouge">start</code> must be greater than <code class="highlighter-rouge">0</code>. For links to the next page, the sum
of <code class="highlighter-rouge">start</code> and <code class="highlighter-rouge">count</code> must be less than the <code class="highlighter-rouge">total</code> number of results.
It’s possible for the <code class="highlighter-rouge">total</code> property to be unspecified, but in this case
the <code class="highlighter-rouge">PageIncrement</code> property of the <code class="highlighter-rouge">CollectionResult</code> must be <code class="highlighter-rouge">RELATIVE</code>
and the amount of results returned by the resource method must match the
<code class="highlighter-rouge">count</code> desired in the request. The reasoning here is that the only way
for Rest.li to know that you’re reaching the end of a collection of
results is if the amount of results returned differs from the amount
requested.</p>

<p>Here is an example request illustrating the use of start &amp; count pagination parameters,
and resulting links in CollectionMetadata:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="s2">"http://localhost:1338/greetings?q=search&amp;start=4&amp;count=2"</span>
<span class="o">{</span>
  <span class="s2">"elements"</span>: <span class="o">[</span> ... <span class="o">]</span>,
  <span class="s2">"paging"</span>: <span class="o">{</span>
    <span class="s2">"count"</span>: 2,
    <span class="s2">"links"</span>: <span class="o">[</span>
      <span class="s2">"href"</span>: <span class="s2">"/greetings?count=10&amp;start=10&amp;q=search"</span>,
      <span class="s2">"rel"</span>: <span class="s2">"next"</span>,
    <span class="s2">"type"</span>: <span class="s2">"application/json"</span>
    <span class="o">]</span>,
    <span class="s2">"start"</span>: 4
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Note that “start” and “count” returned in CollectionMetadata is REQUEST
start and REQUEST count (that is​, the paging parameter passed from
incoming REQUEST, not metadata for the returned response). If start and
count is not passed in Finder or GetAll request, it will return default
0 for start and 10 for count.The rationale behind this is to make it
easier for a client to subsequently construct requests for additional
pages without having to track the start and count themselves.
Furthermore, there is no point to return a count for number of items
returned, since client can easily get that by calling size() for the
elements array returned.</p>

<p><a id="wiki-DependencyInjection"></a></p>

<h2 id="dependency-injection">Dependency Injection</h2>

<p>The Rest.li server framework controls the lifecycle of instances of
Resource classes, instantiating a new Resource object for each request.
It is therefore frequently necessary/desirable for resources to use a
dependency-injection mechanism to obtain the objects they depend upon,
for example, database connections or other resources.</p>

<p>Rest.li includes direct support for the following dependency injection frameworks:</p>

<ul>
  <li><a href="http://www.springsource.org/">Spring</a> using the <a href="/rest.li/Spring-Dependency-Injection">rest.li/spring bridge</a></li>
  <li><a href="https://code.google.com/p/google-guice/">Guice</a> using the <a href="/rest.li/Guice-Dependency-Injection">rest.li/guicebridge</a></li>
</ul>

<p>Other dependency injection frameworks can be used as well. Rest.li
provides an extensible dependency-injection mechanism, through the
<code class="highlighter-rouge">ResourceFactory</code> interface.</p>

<p>The most broadly used dependency injection mechanism is based on mapping
JSR-330 annotations to the Spring ApplicationContext, and it is provided
by the <code class="highlighter-rouge">InjectResourceFactory</code> from <code class="highlighter-rouge">restli-contrib-spring</code>. This is the
recommended approach.</p>

<p>Resource classes may annotate fields with <code class="highlighter-rouge">@Inject</code> or <code class="highlighter-rouge">@Named</code>. If only
<code class="highlighter-rouge">@Inject</code> is specified, the field will be bound to a bean from the
Spring ApplicationContext based on the type of the field. If <code class="highlighter-rouge">@Named</code> is
used, the field will be bound to a bean with the same name. All beans
must be in the root Spring context.</p>

<h2 id="online-documentation">Online Documentation</h2>

<p>Rest.li has an on-line documentation generator that dynamically
generates resource IDL and PDL schemas hosted in the server. The
documentation is available in both HTML and JSON formats, and there are
three ways to access the documentation:</p>

<ol>
  <li>HTML. The relative path to HTML documentation is <code class="highlighter-rouge">restli/docs/</code>. For
example, the documentation URI for resource
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/&lt;context-path&gt;/&lt;resource&gt;</code> is
<code class="highlighter-rouge">GET http://&lt;host&gt;:&lt;port&gt;/&lt;context-path&gt;/restli/docs/rest/&lt;resource&gt;</code>
(<code class="highlighter-rouge">GET</code> is the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3">HTTP GET
method</a>,
which is the default for the web browser). The root URL, such as
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/&lt;context-path&gt;/restli/docs</code>, displays the list
of all accessible resources and data schemas in the server. Use it
as a starting point for HTML documentation. Remember to remove the
<code class="highlighter-rouge">&lt;context-path&gt;</code> part if there is no context path.</li>
  <li>JSON. There are 2 alternative ways to access the raw JSON data:
    <ol>
      <li>Use the <code class="highlighter-rouge">format=json</code> query parameter on any of the HTML pages
above. For example,
<code class="highlighter-rouge">GET http://&lt;host&gt;:&lt;port&gt;/&lt;context-path&gt;/restli/docs/rest/&lt;resource&gt;?format=json</code>
for resource documentation and
<code class="highlighter-rouge">GET http://&lt;host&gt;:&lt;port&gt;/&lt;context-path&gt;/restli/docs/data/&lt;full_name_of_data_schema&gt;?format=json</code>
for schema documentation. Homepage
<code class="highlighter-rouge">GET http://&lt;host&gt;:&lt;port&gt;/&lt;context-path&gt;/restli/docs/?format=json</code>
is also available, which aggregates all resources and data
schemas.</li>
      <li>Use the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.2">HTTP OPTIONS
method</a>.
Simply replace the HTTP GET method with the OPTIONS method when
accessing a resource without using the <code class="highlighter-rouge">format</code> query parameter.
This approach only works for resources, and there is no need for
the special <code class="highlighter-rouge">restli/docs/</code> path. For example,
<code class="highlighter-rouge">OPTIONS http://&lt;host&gt;:&lt;port&gt;/&lt;context-path&gt;/&lt;resource&gt;</code>.</li>
    </ol>
  </li>
</ol>

<p>The JSON format is structured as following:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">models</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">&lt;full_name_of_data_schema_1&gt;</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> <span class="nx">pdsc_of_data_schema_1</span> <span class="p">},</span>
    <span class="dl">"</span><span class="s2">&lt;full_name_of_data_schema_2&gt;</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> <span class="nx">pdsc_of_data_schema_2</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="dl">"</span><span class="s2">resources</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">&lt;resource_1&gt;</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> <span class="nx">idl_of_resource_1</span> <span class="p">},</span>
    <span class="dl">"</span><span class="s2">&lt;resource_2&gt;</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> <span class="nx">idl_of_resource_2</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>When accessing the JSON format of data schema, the <code class="highlighter-rouge">resources</code> key
exists but the value is always empty.</p>

<h3 id="initialize-online-documentation-generator">Initialize Online Documentation Generator</h3>

<ul>
  <li><code class="highlighter-rouge">documentationRequestHandler</code>: instance of
<code class="highlighter-rouge">RestLiDocumentationRequestHandler</code> class, default to null. Specify
which implementation of documentation generator is used in the
server. If null, the on-line documentation feature is disabled.</li>
  <li><code class="highlighter-rouge">serverNodeUri</code>: URI prefix of the server without trailing slash,
default to empty string (“”). The URI prefix is mainly used in the
HTML documents by <code class="highlighter-rouge">DefaultDocumentationRequestHandler</code> to properly
generate links. Usually, this should be an absolute path.</li>
</ul>

                     </div>
                   </div>
</div>



      <footer class="page-footer">
    <div class="container">
      <div class="row">
        <div class="col s6">
          <h5>Rest.li</h5>
          <p class="text-lighten-4">Rest.li is an open source REST framework for building robust, scalable RESTful architectures using type-safe bindings and asynchronous, non-blocking IO. Rest.li fills a niche for applying RESTful principles at scale with an end-to-end developer workflow for building REST APIs, which promotes clean REST practices, uniform interface design and consistent data modeling.</p>
        </div>
        <div class="col s5 offset-s1">
          <h5 class="black-text">Community</h5>
          <ul>
              <li>GitHub <a class="" href="https://github.com/linkedin/rest.li">Rest.li</a></li>
              <li>LinkedIn <a class="" href="https://www.linkedin.com/groups/4855943/">Rest.li Group</a></li>
            <li>Follow us on twitter: <a class="" href="https://twitter.com/rest_li"> @rest_li</a></li>
            <li>Issue Tracking: <a class="" href="https://github.com/linkedin/rest.li/issues">GitHub issue tracking</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
        <div class="container">
            <div class="row">
              <div class="col s6">
                      Copyright 2018 LinkedIn Corporation </br>
                      This work is licensed under a <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.  </br>
                      For clarity, no trademark is licensed.
                      </br></br>
              </div>
              <div class="col s5 offset-s1">
                      This work was made by using Jekyll (and a Jekyll Starter Template)</br>
                      <a target="_blank" href="https://github.com/macrod68/jekyll-materialize-starter-template">https://github.com/macrod68/jekyll-materialize-starter-template</a></br>
                      Copyright © 2017 Marco Damiani. Powered by <a target="_blank" href="http://jekyllrb.com/">Jekyll</a></br>
                      License:<a target="_blank" href="https://opensource.org/licenses/MIT">MIT</a>
              </div>
            </div>
        </div>
    </div>
    <script>
      $(function() {
        return $("h2, h3, h4, h5, h6").each(function(i, el) {
          var $el, icon, id;
          $el = $(el);
          id = $el.attr('id');
          icon = '<i class="fa fa-link"></i>';
          if (id) {
            return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
          }
        });
      });
      </script>
</footer>

      
    <!--  Scripts-->                                                                               
<script src="/rest.li/assets/js/jquery.min.js"></script>
<script src="/rest.li/assets/js/materialize.min.js"></script>
<script src="/rest.li/assets/js/init.js"></script>

  </body>

</html>
